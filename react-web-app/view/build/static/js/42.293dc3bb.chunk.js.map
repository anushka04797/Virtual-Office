{"version":3,"sources":["pages/timecards/SubmittedTimecards.js"],"names":["SubmittedTimecards","dispatch","useDispatch","submitted","profile_details","useSelector","state","profile","data","submitted_timecards","temp","Array","from","timecardList","user_weekly_submitted_timecards","forEach","item","idx","push","id","employee","Weekending","moment","week_end","format","Name","first_name","last_name","Total","total_hours","RHR","SIC","HOL","WFH","OTO","PB1","Submitted","submitted_at","React","useEffect","fetchUserSubmittedTimecards","ExcelJS","require","workbook","Workbook","sheet","addWorksheet","mergeCells","customcell","getCell","value","font","size","bold","alignment","horizontal","vertical","customcell1","getRow","values","name","family","height","columns","key","width","console","log","i","length","addRow","row_num","xlsx","writeBuffer","buffer","blob","Blob","type","day","Date","getDay","saveAs","fileName","useState","setStartDate","setEndDate","nextSatDay","satday","add","toDate","assigneepdf","empid","empName","sdate","edate","subtract","start","end","dateRange","API","get","then","res","filteredData","filter","p","date_updated","hours_total","submittedtc","index","total_not_submitted","parseFloat","hours_today","exportPdfview","className","md","onClick","pdfTitle","doc","jsPDF","setFontSize","content","startY","head","body","map","elt","days","todayDate","text","has_permission","autoTable","save","exportPDF","exportXL","htmlFor","slc_details","slc","department","company","capitalize","items","fields","_style","_classes","sorter","itemsPerPage","pagination","striped","bordered","scopedSlots","color","class","role"],"mappings":"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","file":"static/js/42.293dc3bb.chunk.js","sourcesContent":["import {\r\n  CContainer,\r\n  CRow,\r\n  CCol,\r\n  CDataTable,\r\n  CLabel,\r\n  CButton,\r\n} from \"@coreui/react\";\r\nimport CIcon from \"@coreui/icons-react\";\r\nimport React from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { capitalize, exportPdfview } from \"../../helper\";\r\nimport moment from \"moment\";\r\nimport \"./timeCards.css\";\r\nimport { fetchUserSubmittedTimecards } from \"../../store/slices/TimecardSlice\";\r\nimport jsPDF from \"jspdf\";\r\nimport \"jspdf-autotable\";\r\nimport { useState, useEffect } from \"react\";\r\nimport { has_permission } from \"../../helper.js\";\r\nimport * as FileSaver from \"file-saver\";\r\nimport { saveAs } from \"file-saver\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport { API } from \"../../Config\";\r\n\r\n\r\n\r\nconst SubmittedTimecards = () => {\r\n  const dispatch = useDispatch();\r\n  let submitted = [];\r\n  const profile_details = useSelector((state) => state.profile.data);\r\n  const submitted_timecards = useSelector((state) => {\r\n    let temp = [];\r\n    Array.from(state.timecardList.user_weekly_submitted_timecards).forEach(\r\n      \r\n      (item, idx) => {\r\n        //console.log(\"weekly submitted\", item)\r\n        temp.push({\r\n          id: item.employee.id, \r\n          data: item.employee,\r\n          Weekending: moment(item.week_end).format(\"ddd, MMMM DD, YYYY\"),\r\n          Name: item.employee.first_name + \" \" + item.employee.last_name,\r\n          Total: item.total_hours,\r\n          RHR: item.RHR == null ? \"-\" : item.RHR,\r\n          SIC: item.SIC == null ? \"-\" : item.SIC,\r\n          HOL: item.HOL == null ? \"-\" : item.HOL,\r\n          WFH: item.WFH == null ? \"-\" : item.WFH,\r\n          OTO: item.OTO == null ? \"-\" : item.OTO,\r\n          PB1: item[\"PB1\"] == null ? \"-\" : item[\"PB1\"],\r\n          Submitted:\r\n            moment(item.submitted_at).format(\"ddd, MMMM DD, YYYY\") +\r\n            \" at \" +\r\n            moment(item.submitted_at).format(\"h:mm\"),\r\n        });\r\n      }\r\n    );\r\n\r\n    submitted = [...temp];\r\n    return temp;\r\n  });\r\n\r\n  React.useEffect(() => {\r\n    dispatch(fetchUserSubmittedTimecards());\r\n  }, []);\r\n  const exportPDF = () => {\r\n    const pdfTitle =\r\n      profile_details.first_name + \"_\" + profile_details.last_name;\r\n    const unit = \"pt\";\r\n    const size = \"A4\"; // Use A1, A2, A3 or A4\r\n    const orientation = \"portrait\"; // portrait or landscape\r\n    const marginLeft = 40;\r\n    const doc = new jsPDF(orientation, unit, size);\r\n    doc.setFontSize(15);\r\n    const headers = [\r\n      [\r\n        \"Weekending\",\r\n        \"Name\",\r\n        \"Total\",\r\n        \"RHR\",\r\n        \"SIC\",\r\n        \"HOL\",\r\n        \"PB1\",\r\n        \"WFH\",\r\n        \"OTO\",\r\n        \"Submitted\",\r\n      ],\r\n    ];\r\n    const uData = submitted.map((elt, idx) => [\r\n      elt.Weekending,\r\n      elt.Name,\r\n      elt.Total,\r\n      elt.RHR,\r\n      elt.SIC,\r\n      elt.HOL,\r\n      elt.PB1,\r\n      elt.WFH,\r\n      elt.OTO,\r\n      elt.Submitted,\r\n      console.log(\"data\", elt),\r\n    ]);\r\n    let content = {\r\n      startY: 145,\r\n      head: headers,\r\n      body: uData,\r\n    };\r\n    let day = new Date();\r\n    const weekday = [\r\n      \"Sunday\",\r\n      \"Monday\",\r\n      \"Tuesday\",\r\n      \"Wednesday\",\r\n      \"Thursday\",\r\n      \"Friday\",\r\n      \"Saturday\",\r\n    ];\r\n    let days = weekday[day.getDay()];\r\n    let todayDate = moment(day).format(\"DD-MM-YYYY\");\r\n    console.log(\"days \", todayDate);\r\n    doc.text(170, 50, \"Datasoft Manufacturing & Assembly\");\r\n    doc.setFontSize(13);\r\n    doc.text(245, 75, \"Gulshan Branch\");\r\n    doc.setFontSize(11);\r\n    doc.text(42, 105, \"Submitted Time Card\");\r\n    if (!has_permission(\"projects.add_projects\")) {\r\n      doc.text(42, 125, \"Employee Name: \" + pdfTitle);\r\n    } \r\n    doc.text(440, 360, \"Total \" + submitted.length + \" Submitted\");\r\n    doc.autoTable(content);\r\n    doc.save(pdfTitle + \"_\" + days + \"_\" + todayDate + \"_\" + \".pdf\");\r\n  };\r\n\r\n  async function exportXL() {\r\n    const ExcelJS = require(\"exceljs\");\r\n    const workbook = new ExcelJS.Workbook();\r\n    const sheet = workbook.addWorksheet(\"sheet1\");\r\n    sheet.mergeCells(\"B1:F2\");\r\n    const customcell = sheet.getCell(\"C1\");\r\n    customcell.value = \"Datasoft Manufacturing & Assembly\";\r\n    customcell.font = {\r\n      size: 15,\r\n      bold: true,\r\n    };\r\n    sheet.getCell(\"C1\").alignment = {\r\n      horizontal: \"center\",\r\n      vertical: \"center\",\r\n    };\r\n    sheet.mergeCells(\"C3:D3\");\r\n    const customcell1 = sheet.getCell(\"C3\");\r\n    customcell1.value = \"Gulshan Branch\";\r\n    customcell1.font = {\r\n      size: 13,\r\n      bold: true,\r\n    };\r\n    customcell1.alignment = {\r\n      horizontal: \"center\",\r\n      vertical: \"center\",\r\n    };\r\n    sheet.mergeCells(\"A5:B5\");\r\n    sheet.getCell(\"A5\").value = \"Submitted Timecards\";\r\n    sheet.getRow(8).values = [\r\n      \"Weekending\",\r\n      \"Name\",\r\n      \"Total\",\r\n      \"RHR\",\r\n      \"SIC\",\r\n      \"HOL\",\r\n      \"PB1\",\r\n      \"WFH\",\r\n      \"OTO\",\r\n      \"Submitted\",\r\n    ];\r\n    sheet.getRow(8).font = {\r\n      name: \"Arial Black\",\r\n      family: 3,\r\n\r\n      size: 10,\r\n    };\r\n    sheet.getRow(8).height = 20;\r\n    sheet.columns = [\r\n      { key: \"Weekending\", width: 20 },\r\n      { key: \"Name\", width: 25 },\r\n      { key: \"Total\", width: 10 },\r\n      { key: \"RHR\", width: 10 },\r\n      { key: \"SIC\", width: 10 },\r\n      { key: \"HOL\", width: 10 },\r\n      { key: \"PB1\", width: 10 },\r\n      { key: \"WFH\", width: 10 },\r\n      { key: \"OTO\", width: 10 },\r\n      { key: \"Submitted\", width: 20 },\r\n    ];\r\n    console.log(\"submitted\", submitted);\r\n    for (let i = 0; i < submitted.length; i++) {\r\n      sheet.addRow({\r\n        Weekending: submitted[i].Weekending,\r\n        Name: submitted[i].Name,\r\n        Total: submitted[i].Total,\r\n        RHR: submitted[i].RHR,\r\n        SIC: submitted[i].SIC,\r\n        HOL: submitted[i].HOL,\r\n        PB1: submitted[i].PB1,\r\n        WFH: submitted[i].WFH,\r\n        OTO: submitted[i].OTO,\r\n        Submitted: submitted[i].Submitted,\r\n      });\r\n    }\r\n    let row_num = submitted.length + 11;\r\n    let total = submitted_timecards.length;\r\n    if (total != 0) {\r\n      sheet.getRow(row_num).values = [\"Total Submitted =  \" + submitted.length];\r\n    }\r\n    const buffer = await workbook.xlsx.writeBuffer();\r\n    const fileType = \"application/octet-stream\";\r\n    const fileExtension = \".xlsx\";\r\n    const blob = new Blob([buffer], { type: fileType });\r\n    const pdfTitle =\r\n      profile_details.first_name + \"_\" + profile_details.last_name;\r\n    let day = new Date();\r\n    const weekday = [\r\n      \"Sunday\",\r\n      \"Monday\",\r\n      \"Tuesday\",\r\n      \"Wednesday\",\r\n      \"Thursday\",\r\n      \"Friday\",\r\n      \"Saturday\",\r\n    ];\r\n    let days = weekday[day.getDay()];\r\n    let todayDate = moment(day).format(\"DD-MM-YYYY\");\r\n     \r\n      pdfTitle + \"_\" + days + \"_\" + todayDate + \"_\" + fileExtension;\r\n    saveAs(blob, fileName);\r\n  }\r\n  const [startDate, setStartDate] = useState(\"\");\r\n  const [endDate, setEndDate] = useState(\"\");\r\n  const [totalHrs, setTotalHrs] = useState(0);\r\n\r\n  const nextSatDay = () => {\r\n    var satday = new Date();\r\n    for (let i = 0; i < 7; i++) {\r\n      if (satday.getDay() === 6) {\r\n        console.log(\"sat\", satday);\r\n        break;\r\n      } else {\r\n        satday = moment(satday).add(1, \"day\").toDate();\r\n      }\r\n    }\r\n    satday = moment(satday).format(\"YYYY-MM-DD\");\r\n    return satday;\r\n  };\r\n  const dateRange = () => {\r\n    var sdate = new Date();\r\n    var edate = new Date();\r\n\r\n    for (let i = 0; i < 7; i++) {\r\n      if (sdate.getDay() === 0) {\r\n        console.log(\"start\", sdate);\r\n        break;\r\n      } else {\r\n        sdate = moment(sdate).subtract(1, \"day\").toDate();\r\n      }\r\n    }\r\n    console.log(\"end date\", edate);\r\n\r\n    setStartDate(moment(sdate).format(\"YYYY-MM-DD\"));\r\n    setEndDate(nextSatDay());\r\n    \r\n    return {\r\n      start: moment(sdate).format(\"YYYY-MM-DD\"),\r\n      end: nextSatDay(),\r\n    };\r\n  };\r\n\r\n  const assigneepdf = (empid, empName) =>{\r\n   console.log(\"id : \", empid, \"Name \", empName)\r\n   const { start, end } = dateRange();\r\n\r\n   API.get(\"wbs/user/time-card/list/\" + empid + \"/\").then((res) => {\r\n    //console.log(\"assignee tc\", res.data);\r\n    let temp = [];\r\n      Array.from(res.data.data).forEach((item, idx) => {\r\n        temp.push({ data: item });\r\n      });\r\n      let filteredData = temp;\r\n      filteredData = temp.filter(\r\n        (p) => p.data.date_updated >= start && p.data.date_updated <= end\r\n      );\r\n\r\n      console.log(\"filtered\", filteredData);\r\n\r\n      let hours_total = 0;\r\n      let total_not_submitted = 0;\r\n      let submittedtc =[]\r\n\r\n      for (let index = 0; index < filteredData.length; index++) {\r\n        if (filteredData[index].data.submitted == false) {\r\n          total_not_submitted++;\r\n        }\r\n        if(filteredData[index].data.submitted == true)\r\n        {\r\n          //submittedtc[index] = filteredData[index]\r\n          submittedtc.push(filteredData[index])\r\n          hours_total += parseFloat(filteredData[index].data.hours_today)\r\n        }\r\n        // const element = notsubmitted[index];\r\n        //  hours_total += parseFloat(element.data.hours_today);\r\n\r\n      }\r\n      console.log(\"submittedtcs\", submittedtc)\r\n      console.log(\"total hours\", hours_total)\r\n      exportPdfview(submittedtc, empName, end, hours_total, start )\r\n\r\n      \r\n      \r\n   })\r\n  }\r\n  return (\r\n    <>\r\n      <CContainer>\r\n        <CRow>\r\n          <CCol>\r\n            <h3 className=\"timecards-page-header mb-3\">Submitted Timecards</h3>\r\n          </CCol>\r\n          <CCol md=\"8\" id=\"tableRef\" className=\"d-flex justify-content-end\">\r\n            <h5 className=\"tiny-header--5 mt-3 mr-2\">Export </h5>\r\n            <div className=\"format-buttons mt-3 mb-3 \">\r\n              <CButton\r\n                className=\"file-format-download\"\r\n                onClick={() => {\r\n                  exportPDF();\r\n                }}\r\n              >\r\n                <CIcon name=\"cil-description\" className=\"mr-2\" /> PDF\r\n              </CButton>\r\n              <CButton\r\n                className=\"file-format-download\"\r\n                onClick={() => {\r\n                  exportXL();\r\n                }}\r\n              >\r\n                <CIcon name=\"cil-spreadsheet\" className=\"mr-2\" />\r\n                Excel\r\n              </CButton>\r\n              {/* <CButton className=\"file-format-download\">Print</CButton> */}\r\n            </div>\r\n          </CCol>\r\n        </CRow>\r\n        <CRow className=\"mt-4\">\r\n          <CCol>\r\n            <CLabel className=\"custom-label-5\" htmlFor=\"assigneeSelect\">\r\n              Company :{\" \"}\r\n              {profile_details.slc_details?.slc?.department?.company?.name}\r\n            </CLabel>\r\n          </CCol>\r\n        </CRow>\r\n        <CRow>\r\n          {!has_permission(\"projects.add_projects\") && (\r\n            <CCol>\r\n              <CLabel className=\"custom-label-5\" htmlFor=\"assigneeSelect\">\r\n                Employee Name :{\" \"}\r\n                {capitalize(profile_details.first_name) +\r\n                  \" \" +\r\n                  capitalize(profile_details.last_name)}\r\n              </CLabel>\r\n            </CCol>\r\n          )}\r\n        </CRow>\r\n        <CRow className=\"mt-5\">\r\n          <CCol>\r\n            <CDataTable\r\n              items={submitted_timecards}\r\n              fields={[\r\n                {\r\n                  key: \"Weekending\",\r\n                  _style: { width: \"15%\" },\r\n                  _classes: \"font-weight-bold\",\r\n                },\r\n                \"Name\",\r\n                \"Total\",\r\n                {\r\n                  key: \"RHR\",\r\n                  sorter: false,\r\n                },\r\n                {\r\n                  key: \"SIC\",\r\n                  sorter: false,\r\n                },\r\n                {\r\n                  key: \"HOL\",\r\n                  sorter: false,\r\n                },\r\n                {\r\n                  key: \"PB1\",\r\n                  sorter: false,\r\n                },\r\n                {\r\n                  key: \"WFH\",\r\n                  sorter: false,\r\n                },\r\n                {\r\n                  key: \"OTO\",\r\n                  sorter: false,\r\n                },\r\n                {\r\n                  key: \"Submitted\",\r\n                  sorter: false,\r\n                },\r\n              ]}\r\n              itemsPerPage={10}\r\n              pagination\r\n              striped\r\n              bordered\r\n              sorter\r\n              scopedSlots={{\r\n                Name: (item) => (\r\n                  <td>\r\n                    <a\r\n                      onClick={() => {assigneepdf(item[\"id\"], item[\"Name\"])}}\r\n                      size=\"sm\"\r\n                      type=\"button\"\r\n                      color=\"primary\"\r\n                    >\r\n                      <u> {item[\"Name\"]}</u>\r\n                    </a>\r\n                  </td>\r\n                ),\r\n              }}\r\n            />\r\n            <div class=\"alert alert-info\" role=\"alert\">\r\n              <CRow>\r\n                <CCol md=\"5\"></CCol>\r\n                <CCol md=\"3\"></CCol>\r\n                <CCol md=\"4\">\r\n                  {\r\n                    <small>\r\n                      {\"   \"}\r\n                      Total <b>&nbsp;{submitted_timecards.length}&nbsp;</b>{\" \"}\r\n                      Submitted\r\n                    </small>\r\n                  }\r\n                </CCol>\r\n              </CRow>\r\n            </div>\r\n          </CCol>\r\n        </CRow>\r\n      </CContainer>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default SubmittedTimecards;\r\n"],"sourceRoot":""}