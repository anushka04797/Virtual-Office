(this.webpackJsonpvirtual_office=this.webpackJsonpvirtual_office||[]).push([[29],{502:function(e,t){},522:function(e,t){},523:function(e,t){},672:function(e,t,a){},958:function(e,t,a){"use strict";a.r(t);var s=a(19),n=a(33),d=a(0),c=a.n(d),o=(a(672),a(513)),r=a(9),u=a(95),i=a(595),l=(a(674),a(517)),y=a(518),m=a(492),j=a(73),f=a.n(j),b=a(489),h=a(102),p=a(4);t.default=function(){var e=Object(u.c)((function(e){return e.profile.data})),t=Object(d.useState)([]),a=Object(n.a)(t,2),j=a[0],_=a[1],O=[],x=Object(d.useState)([]),T=Object(n.a)(x,2),S=T[0],Y=T[1],v=Object(d.useState)(),w=Object(n.a)(v,2),k=(w[0],w[1],Object(d.useState)()),M=Object(n.a)(k,2),N=M[0],g=M[1],D=Object(d.useState)(),F=Object(n.a)(D,2),W=F[0],B=F[1],V=Object(d.useState)([]),E=Object(n.a)(V,2),C=E[0],R=E[1],A=Object(d.useState)([]),J=Object(n.a)(A,2),P=(J[0],J[1]),z=Object(d.useState)(0),H=Object(n.a)(z,2),q=H[0],I=H[1],U=Object(d.useState)(!1),G=Object(n.a)(U,2),K=(G[0],G[1],[]),L=Object(h.b)(),Q=L.enqueueSnackbar;L.closeSnackbar;function X(){r.a.get("wbs/user-wise/weekly-time-card/"+sessionStorage.getItem(r.j)+"/").then((function(e){if(g(e.data.start_date),B(e.data.end_date),void 0!=e.data.data&&e.data.data.forEach((function(e,t){K.push(e.project.sub_task);var a={id:e.id,project:e.project,time_card_assignee:e.time_card_assignee,actual_work_done:e.actual_work_done,time_type:e.time_type,submitted:e.submitted,hours_today:e.hours_today,date_created:e.date_created,date_updated:e.date_updated};O.push(a)})),console.log(K),console.log("new array",O),Y(O),0!=O.length||void 0!=O){for(var t=[],a=0,s=0;s<O.length;s++){var n=O[s];a+=parseFloat(n.hours_today),console.log(n.date_updated);var d=f()(n.date_updated).weekday();t.push({"No.":s+1,id:n.id,WBS:n.actual_work_done,Time:n.time_type,Sunday:0==d?n.hours_today:"",Monday:1==d?n.hours_today:"",Tuesday:2==d?n.hours_today:"",Wednesday:3==d?n.hours_today:"",Thursday:4==d?n.hours_today:"",Friday:5==d?n.hours_today:"",Saturday:6==d?n.hours_today:"",Total:n.hours_today}),console.log(f()(n.date_updated).weekday())}t.push({"No.":"",id:"",WBS:"",Time:"",Sunday:"",Monday:"",Tuesday:"",Wednesday:"",Thursday:"",Friday:"",Saturday:"",Total:"Total = "+a.toFixed(1)}),_(t),P(t),I(a.toFixed(1)),console.log("tabledata from weekly timecard",q)}}))}c.a.useEffect((function(){window.scrollTo(0,0),X()}),[]),c.a.useEffect((function(){R(K)}),[]);Object(o.a)({initialValues:{wbs:"",time:"",hrs:""},validateOnBlur:!0,validateOnChange:!0});var Z=[{value:"RHR",label:"RHR"},{value:"OTO",label:"OTO"}];function $(e,t){console.log(e.target.value,t);var a={time_type:t.Time,hours_today:e.target.value,date_updated:""};r.a.put("wbs/time-card/update/"+t.id+"/",a).then((function(e){console.log(e),200===e.status&&(X(),Q("Actual hours update succefull.",{variant:"info"}))}))}return Object(p.jsx)(p.Fragment,{children:Object(p.jsxs)(b.l,{children:[Object(p.jsx)("h3",{className:"timecards-page-header mb-3",children:"Weekly Timecard"}),Object(p.jsxs)(b.J,{children:[0!=j.length&&Object(p.jsxs)(b.k,{md:"12",children:[Object(p.jsx)("h5",{className:"tiny-header--5 mt-0",children:"Export"}),Object(p.jsxs)("div",{className:"format-buttons mt-3 mb-3",children:[Object(p.jsxs)(b.f,{className:"file-format-download",onClick:function(){return function(){var t=new i.default("landscape","pt","A4");t.setFontSize(12);var a=e.first_name+"_"+e.last_name+"_Timecard_"+f()(N).format("DD/MM/YYYY")+"-"+f()(W).format("DD/MM/YYYY");console.log("pdfData",S);var s={startY:50,head:[["No.","WBS","Time","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Total"]],body:j.map((function(e,t){return[t+1,e.WBS,e.Time,e.Sunday,e.Monday,e.Tuesday,e.Wednesday,e.Thursday,e.Friday,e.Saturday,e.Total]}))};t.text(a,40,30),t.autoTable(s),t.save(e.first_name+"_"+e.last_name+"_Timecard_"+f()(N).format("DD/MM/YYYY")+"-"+f()(W).format("DD/MM/YYYY")+".pdf")}()},children:[Object(p.jsx)(m.a,{name:"cil-description",className:"mr-2"}),"PDF"]}),Object(p.jsxs)(b.f,{className:"file-format-download",onClick:function(){return function(e,t){console.log(e);var a={Sheets:{data:y.utils.json_to_sheet(e)},SheetNames:["data"]},s=y.write(a,{bookType:"xlsx",type:"array"}),n=new Blob([s],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});l.saveAs(n,t+".xlsx")}(j,e.first_name+"_"+e.last_name+"_Timecard_"+f()(N).format("DD/MM/YYYY")+"-"+f()(W).format("DD/MM/YYYY"))},children:[Object(p.jsx)(m.a,{name:"cil-spreadsheet",className:"mr-2"}),"Excel"]})]})]}),Object(p.jsxs)(b.k,{md:"4",children:["Name: ",e.first_name+" "+e.last_name,Object(p.jsx)("br",{}),"Phone: +",e.phone]}),Object(p.jsxs)(b.k,{md:"4",children:["Week: ",f()(N).format("DD/MM/YYYY")," - ",f()(W).format("DD/MM/YYYY")," ",Object(p.jsx)("br",{}),"Month: ",f()(W).format("MMMM")," ",Object(p.jsx)("br",{}),"Year: ",f()(W).format("YYYY")]}),Object(p.jsxs)(b.k,{md:"4",children:["Project Name(s): ",Object(s.a)(new Set(C)).map((function(e,t){return Object(p.jsxs)("span",{children:[e,t<C.length-1&&Object(p.jsx)("span",{children:", "})]})}))]}),Object(p.jsx)(b.k,{md:"12",children:Object(p.jsx)("div",{className:"mt-4 mb-2",children:Object(p.jsx)(b.m,{items:j,fields:[{key:"No.",_style:{width:"auto"},_classes:"font-weight-bold"},"WBS",{key:"Time",_style:{width:"100px"}},{key:"Sunday",_style:{width:"70px"}},{key:"Monday",_style:{width:"70px"}},{key:"Tuesday",_style:{width:"70px"}},{key:"Wednesday",_style:{width:"70px"}},{key:"Thursday",_style:{width:"70px"}},{key:"Friday",_style:{width:"70px"}},{key:"Saturday",_style:{width:"70px"}},{key:"Total",_style:{width:"auto"}}],primary:!0,hover:!0,striped:!0,bordered:!0,size:"sm",scopedSlots:{Time:function(e,t){return Object(p.jsx)("td",{className:"py-2",children:""!=e.Time&&Object(p.jsx)("select",{onChange:function(t){!function(e,t){console.log(e.target.value,t);var a={time_type:e.target.value,hours_today:t.Total,date_updated:""};r.a.put("wbs/time-card/update/"+t.id+"/",a).then((function(e){console.log(e),200===e.status&&(X(),Q("Time type update succefull.",{variant:"info"}))}))}(t,e)},children:Z.map((function(t){return Object(p.jsx)("option",{selected:t.value==e.Time,children:t.value})}))})})},Sunday:function(e,t){return Object(p.jsx)("td",{className:"py-2",children:""!=e.Sunday&&Object(p.jsx)(b.y,{name:"Sunday",type:"number",onBlur:function(t){$(t,e)},defaultValue:e.Sunday,className:"custom-forminput-6"})})},Monday:function(e,t){return Object(p.jsx)("td",{className:"py-2",children:""!=e.Monday&&Object(p.jsx)(b.y,{name:"Monday",type:"number",onBlur:function(t){$(t,e)},defaultValue:e.Monday,className:"custom-forminput-6"})})},Tuesday:function(e,t){return Object(p.jsx)("td",{className:"py-2",children:""!=e.Tuesday&&Object(p.jsx)(b.y,{name:"Tuesday",type:"number",onBlur:function(t){$(t,e)},defaultValue:e.Tuesday,className:"custom-forminput-6"})})},Wednesday:function(e,t){return Object(p.jsx)("td",{className:"py-2",children:""!=e.Wednesday&&Object(p.jsx)(b.y,{name:"Wednesday",type:"number",onBlur:function(t){$(t,e)},defaultValue:e.Wednesday,className:"custom-forminput-6"})})},Thursday:function(e,t){return Object(p.jsx)("td",{className:"py-2",children:""!=e.Thursday&&Object(p.jsx)(b.y,{name:"Thursday",type:"number",onBlur:function(t){$(t,e)},defaultValue:e.Thursday,className:"custom-forminput-6"})})},Friday:function(e,t){return Object(p.jsx)("td",{className:"py-2",children:""!=e.Friday&&Object(p.jsx)(b.y,{name:"Friday",type:"number",onBlur:function(t){$(t,e)},defaultValue:e.Friday,className:"custom-forminput-6"})})},Saturday:function(e,t){return Object(p.jsx)("td",{className:"py-2",children:""!=e.Saturday&&Object(p.jsx)(b.y,{name:"Saturday",type:"number",onBlur:function(t){$(t,e)},defaultValue:e.Saturday,className:"custom-forminput-6"})})}}})})})]})]})})}}}]);
//# sourceMappingURL=29.d55a408e.chunk.js.map