(this.webpackJsonpvirtual_office=this.webpackJsonpvirtual_office||[]).push([[37],{1217:function(e,t,a){"use strict";a.r(t);var l=a(9),s=a(33),n=a(5),o=a.n(n),i=a(496),r=(a(821),a(0)),c=(a(95),a(8)),d=(a(505),a(522),a(644)),u=(a(671),a(509)),f=(a(73),a(511),a(534)),h=(a(1218),a(4));t.default=function(){var e=Object(r.useState)([]),t=Object(s.a)(e,2),n=(t[0],t[1]),m=Object(r.useState)([]),b=Object(s.a)(m,2),j=b[0],y=b[1],g=Object(r.useState)([]),x=Object(s.a)(g,2),p=x[0],O=x[1];function v(){return(v=Object(l.a)(o.a.mark((function e(){var t,l,s,n,i,r,c,d,u;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=a(785),l=new t.Workbook,(s=l.addWorksheet("sheet1")).mergeCells("B1:D2"),(n=s.getCell("C1")).value="Datasoft Manufacturing & Assembly",n.font={size:15,bold:!0},s.getCell("C1").alignment={horizontal:"center",vertical:"center"},s.mergeCells("B3:D3"),(i=s.getCell("C3")).value="Gulshan Branch",i.font={size:13,bold:!0},i.alignment={horizontal:"center",vertical:"center"},s.mergeCells("A5:B5"),s.getCell("A5").value="List of Holidays",s.getCell("A5").font={bold:!0},s.getCell("E5").value="Total Holidays "+p.length,s.getCell("E5").font={bold:!0},s.mergeCells("F6:G6"),s.mergeCells("A6:D6"),s.getRow(8).values=["Year","Holiday Title","Start Date","End Date","Hours"],s.getRow(8).font={name:"Arial Black",family:3,size:10},s.getRow(9).height=20,s.columns=[{key:"year",width:10},{key:"title",width:30},{key:"start",width:15},{key:"end",width:15},{key:"hours",width:15}],r=0;r<p.length;r++)s.addRow({year:p[r].Year,title:p[r].holiday_title,start:p[r].start_date,end:p[r].end_date,hours:p[r].hours});return c=p.length+12,s.getRow(c).values=["","","","","Total Holidays = "+p.length],s.getRow(c).font={bold:!0},e.next=30,l.xlsx.writeBuffer(p);case 30:d=e.sent,"application/octet-stream",".xlsx",u=new Blob([d],{type:"application/octet-stream"}),"List-of-Holidays.xlsx",Object(f.saveAs)(u,"List-of-Holidays.xlsx");case 36:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(r.useEffect)((function(){c.a.get("organizations/holiday/all/").then((function(e){console.log("res",e.data.data),n(e.data.data),function(e){for(var t=[],a=0;a<e.length;a++)t.push({Year:e[a].Year,"Holiday Title":e[a].holiday_title,"Start Date":e[a].start_date,"End Date":e[a].end_date,Hours:e[a].hours}),console.log("table data ",t);y(t)}(e.data.data),O(e.data.data)})),console.log("hello")}),[]),Object(h.jsxs)(i.l,{children:[Object(h.jsx)(i.K,{className:"justify-content-between",children:Object(h.jsxs)(i.k,{md:"12",children:[Object(h.jsxs)(i.K,{className:"justify-content-between",children:[Object(h.jsx)(i.k,{children:Object(h.jsx)("h3",{className:"timecards-page-header mb-3",children:"List of Holidays"})}),Object(h.jsxs)(i.k,{md:"8",id:"tableRef",className:"d-flex justify-content-end",children:[Object(h.jsx)("h5",{className:"tiny-header--5 mt-3 mr-2",children:"Export "}),Object(h.jsxs)("div",{className:"format-buttons mt-3 mb-3 ",children:[Object(h.jsxs)(i.f,{className:"file-format-download",onClick:function(){return function(){var e=new d.default("portrait","pt","A4");e.setFontSize(15);var t=p.map((function(e,t){return[e.Year,e.holiday_title,e.start_date,e.end_date,e.hours]}));console.log("pdfData",t);var a={startY:140,head:[["Year","Holiday Title","Start Date","End Date","Hours"]],body:t};e.setFontSize(18),e.text(165,50,"Datasoft Manufacturing & Assembly"),e.setFontSize(14),e.text(230,65,"Gulshan Branch"),e.setFontSize(12),e.text(42,100,"List of Holidays"),e.text(450,100,"Total Holidays "+p.length),e.autoTable(a),e.save("List-of-Holidays.pdf")}()},children:[Object(h.jsx)(u.a,{name:"cil-description",className:"mr-2"})," PDF"]}),Object(h.jsxs)(i.f,{className:"file-format-download",onClick:function(){return function(){return v.apply(this,arguments)}()},children:[Object(h.jsx)(u.a,{name:"cil-spreadsheet",className:"mr-2"}),"Excel"]})]})]})]}),Object(h.jsx)(i.m,{items:j,fields:["Year","Holiday Title","Start Date","End Date","Hours"],primary:!0,hover:!0,striped:!0,bordered:!0,sorter:!0,size:"sm",itemsPerPage:20,pagination:!0})]})}),Object(h.jsx)(i.K,{className:"justify-content-end mb-5",children:Object(h.jsxs)(i.k,{md:"2",className:"justify-content-end tiny-header--5",children:["Total Holidays ",j.length]})})]})}},1218:function(e,t,a){},821:function(e,t,a){var l=a(174),s=a(27);e.exports=function(e,t,a,n){return null==e?[]:(s(t)||(t=null==t?[]:[t]),s(a=n?void 0:a)||(a=null==a?[]:[a]),l(e,t,a))}}}]);
//# sourceMappingURL=37.868d7c57.chunk.js.map