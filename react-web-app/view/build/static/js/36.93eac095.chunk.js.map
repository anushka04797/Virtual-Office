{"version":3,"sources":["pages/timecards/SubmittedTimecards.js","../../src/FileSaver.js"],"names":["SubmittedTimecards","useState","submitted","profile_details","useSelector","state","profile","data","submitted_timecards","temp","Array","from","timecardList","user_weekly_submitted_timecards","forEach","item","idx","push","Weekending","moment","week_end","format","Name","employee","first_name","last_name","Total","total_hours","RHR","SIC","HOL","WFH","OTO","PB1","Submitted","submitted_at","dispatch","useDispatch","React","useEffect","fetchUserSubmittedTimecards","className","md","id","onClick","pdfTitle","doc","jsPDF","setFontSize","content","startY","head","body","map","elt","console","log","text","has_permission","length","autoTable","save","exportPDF","name","htmlFor","slc_details","slc","department","company","capitalize","items","fields","key","_style","width","_classes","sorter","itemsPerPage","pagination","striped","bordered","class","role","b","a","autoBom","warn","test","type","Blob","c","d","XMLHttpRequest","open","responseType","onload","g","response","onerror","error","send","status","e","dispatchEvent","MouseEvent","document","createEvent","initMouseEvent","window","f","self","global","navigator","userAgent","saveAs","HTMLAnchorElement","prototype","h","i","URL","webkitURL","j","createElement","download","rel","href","origin","location","target","createObjectURL","setTimeout","revokeObjectURL","msSaveOrOpenBlob","title","innerText","HTMLElement","safari","FileReader","k","onloadend","result","replace","readAsDataURL","l","m","module","exports"],"mappings":"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","file":"static/js/36.93eac095.chunk.js","sourcesContent":["import {\r\n  CContainer,\r\n  CRow,\r\n  CCol,\r\n  CDataTable,\r\n  CLabel,\r\n  CButton,\r\n} from \"@coreui/react\";\r\nimport CIcon from \"@coreui/icons-react\";\r\nimport React from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { capitalize } from \"../../helper\";\r\nimport moment from \"moment\";\r\nimport \"./timeCards.css\";\r\nimport { fetchUserSubmittedTimecards } from \"../../store/slices/TimecardSlice\";\r\nimport jsPDF from \"jspdf\";\r\nimport \"jspdf-autotable\";\r\nimport { useState } from \"react\";\r\nimport { has_permission } from \"../../helper.js\";\r\nimport * as FileSaver from \"file-saver\";\r\nconst SubmittedTimecards = () => {\r\n  const [pdfData, setPdfData] = useState([]);\r\n  let submitted =[]\r\n  const profile_details = useSelector((state) => state.profile.data);\r\n  const submitted_timecards = useSelector((state) => {\r\n    let temp = [];\r\n    Array.from(state.timecardList.user_weekly_submitted_timecards).forEach(\r\n      (item, idx) => {\r\n        temp.push({\r\n          Weekending: moment(item.week_end).format(\"ddd, MMMM DD, YYYY\"),\r\n          Name: item.employee.first_name + \" \" + item.employee.last_name,\r\n          Total: item.total_hours,\r\n          RHR: item.RHR == null ? \"-\" : item.RHR,\r\n          SIC: item.SIC == null ? \"-\" : item.SIC,\r\n          HOL: item.HOL == null ? \"-\" : item.HOL,\r\n          WFH: item.WFH == null ? \"-\" : item.WFH,\r\n          OTO: item.OTO == null ? \"-\" : item.OTO,\r\n          PB1: item[\"PB1\"] == null ? \"-\" : item[\"PB1\"],\r\n          Submitted:\r\n            moment(item.submitted_at).format(\"ddd, MMMM DD, YYYY\") +\r\n            \" at \" +\r\n            moment(item.submitted_at).format(\"h:mm\"),\r\n        });\r\n      }\r\n    );\r\n    \r\n    submitted=[...temp]\r\n    return temp;\r\n  });\r\n  const dispatch = useDispatch();\r\n  const nextSatDay = () => {\r\n    var satday = new Date();\r\n    for (let i = 0; i < 7; i++) {\r\n      if (satday.getDay() === 6) {\r\n        console.log(\"sat\", satday);\r\n        break;\r\n      } else {\r\n        satday = moment(satday).add(1, \"day\").toDate();\r\n      }\r\n    }\r\n    satday = moment(satday).format(\"YYYY-MM-DD\");\r\n    return satday;\r\n  };\r\n  React.useEffect(() => {\r\n    dispatch(fetchUserSubmittedTimecards());\r\n\r\n    \r\n  }, []);\r\n  const exportPDF = () => {\r\n    \r\n    const pdfTitle =\r\n      profile_details.first_name + \" \" + profile_details.last_name;\r\n\r\n    const unit = \"pt\";\r\n    const size = \"A4\"; // Use A1, A2, A3 or A4\r\n    const orientation = \"portrait\"; // portrait or landscape\r\n\r\n    const marginLeft = 40;\r\n    const doc = new jsPDF(orientation, unit, size);\r\n\r\n    doc.setFontSize(15);\r\n\r\n    const title = \"Timecard of\"; //+ \" \" + pdfTitle;\r\n    const headers = [\r\n      [\r\n        \"Weekending\",\r\n        \"Name\",\r\n        \"Total\",\r\n        \"RHR\",\r\n        \"SIC\",\r\n        \"HOL\",\r\n        \"PB1\",\r\n        \"WFH\",\r\n        \"OTO\",\r\n        \"Submitted\",\r\n      ],\r\n    ];\r\n    const uData = submitted.map((elt, idx) => [\r\n      elt.Weekending,\r\n      elt.Name,\r\n      elt.Total,\r\n      elt.RHR,\r\n      elt.SIC,\r\n      elt.HOL,\r\n      elt.PB1,\r\n      elt.WFH,\r\n      elt.OTO, \r\n      elt.Submitted, \r\n      console.log(\"data\", elt),\r\n    ]);\r\n    let content = {\r\n      startY: 145,\r\n      head: headers,\r\n      body: uData,\r\n    };\r\n\r\n    // let day = new Date();\r\n    // let time = day.toLocaleString(\"en-US\", {\r\n    //   hour: \"numeric\",\r\n    //   minute: \"numeric\",\r\n    //   hour12: true,\r\n    // });\r\n    // day = moment(day).format(\"DD/MM/YY\");\r\n    // const edate = moment(endDate).format(\"DD/MM/YYYY\");\r\n    // doc.setFontSize(17);\r\n    doc.text(170, 50, \"Datasoft Manufacturing & Assembly\");\r\n    doc.setFontSize(13);\r\n    doc.text(245, 75, \"Gulshan Branch\");\r\n    doc.setFontSize(11);\r\n    doc.text(42, 105, \"Submitted Time Card\");\r\n    // doc.text(410, 105, \"Week-Ending: \" + edate); //+ edate)\r\n    if(!has_permission(\"projects.add_projects\"))\r\n\r\n       {doc.text(42, 125, \"Employee Name: \" + pdfTitle)} //+ name)\r\n\r\n    // let date = new Date();\r\n    // console.log(\"date\", date);\r\n    doc.text(440, 360, \"Total \" +submitted.length+ \" Submitted\");\r\n\r\n    // doc.text(400, 375, \"Submitted : \" + time + \"  \" + day);\r\n\r\n    doc.autoTable(content);\r\n\r\n    // var blobPDF =  new Blob([ doc.output('blob') ], { type: 'application/vnd.ms-excel' });\r\n\r\n    //let blob = new Blob([csv], { type: 'application/vnd.ms-excel' });\r\n    doc.save(\"Timecard of\" + \" \" + pdfTitle + \".pdf\");\r\n    \r\n    // FileSaver.saveAs(blobPDF, \"dummy.csv\");\r\n    // console.log(\"data\", pdfData);\r\n  };\r\n  const exportXL =()=>{\r\n    const fileType = \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8\";\r\n    \r\n\r\n  }\r\n  return (\r\n    <>\r\n      <CContainer>\r\n        <CRow>\r\n          <CCol>\r\n            <h3 className=\"timecards-page-header mb-3\">Submitted Timecards</h3>\r\n          </CCol>\r\n          <CCol md=\"8\" id=\"tableRef\" className=\"d-flex justify-content-end\">\r\n            <h5 className=\"tiny-header--5 mt-3 mr-2\">Export </h5>\r\n            <div className=\"format-buttons mt-3 mb-3 \">\r\n              <CButton\r\n                className=\"file-format-download\"\r\n                onClick={() => {\r\n                  exportPDF();\r\n                }}\r\n              >\r\n                <CIcon name=\"cil-description\" className=\"mr-2\" /> PDF\r\n              </CButton>\r\n              <CButton className=\"file-format-download\" onClick={() => {exportXL();}}>\r\n                <CIcon name=\"cil-spreadsheet\" className=\"mr-2\" />\r\n                Excel\r\n              </CButton>\r\n              {/* <CButton className=\"file-format-download\">Print</CButton> */}\r\n            </div>\r\n          </CCol>\r\n        </CRow>\r\n        <CRow className=\"mt-4\">\r\n          <CCol>\r\n            <CLabel className=\"custom-label-5\" htmlFor=\"assigneeSelect\">\r\n              Company :{\" \"}\r\n              {profile_details.slc_details?.slc?.department?.company?.name}\r\n            </CLabel>\r\n          </CCol>\r\n        </CRow>\r\n        <CRow>\r\n        {!has_permission(\"projects.add_projects\") && \r\n          <CCol>\r\n            <CLabel className=\"custom-label-5\" htmlFor=\"assigneeSelect\">\r\n              Employee Name :{\" \"}\r\n              {capitalize(profile_details.first_name) +\r\n                \" \" +\r\n                capitalize(profile_details.last_name)}\r\n            </CLabel>\r\n          </CCol>}\r\n        </CRow>\r\n        <CRow className=\"mt-5\">\r\n          <CCol>\r\n            <CDataTable\r\n              items={submitted_timecards}\r\n              fields={[\r\n                {\r\n                  key: \"Weekending\",\r\n                  _style: { width: \"15%\" },\r\n                  _classes: \"font-weight-bold\",\r\n                },\r\n                \"Name\",\r\n                \"Total\",\r\n                {\r\n                  key: \"RHR\",\r\n                  sorter: false,\r\n                },\r\n                {\r\n                  key: \"SIC\",\r\n                  sorter: false,\r\n                },\r\n                {\r\n                  key: \"HOL\",\r\n                  sorter: false,\r\n                },\r\n                {\r\n                  key: \"PB1\",\r\n                  sorter: false,\r\n                },\r\n                {\r\n                  key: \"WFH\",\r\n                  sorter: false,\r\n                },\r\n                {\r\n                  key: \"OTO\",\r\n                  sorter: false,\r\n                },\r\n                {\r\n                  key: \"Submitted\",\r\n                  sorter: false,\r\n                },\r\n              ]}\r\n              itemsPerPage={10}\r\n              pagination\r\n              striped\r\n              bordered\r\n              sorter\r\n            />\r\n            <div class=\"alert alert-info\" role=\"alert\">\r\n              <CRow>\r\n                <CCol md=\"5\"></CCol>\r\n                <CCol md=\"3\"></CCol>\r\n                <CCol md=\"4\">\r\n                  {\r\n                    <small>\r\n                      {\"   \"}\r\n                      Total <b>&nbsp;{submitted_timecards.length}&nbsp;</b>{\" \"}\r\n                      Submitted\r\n                    </small>\r\n                  }\r\n                </CCol>\r\n              </CRow>\r\n            </div>\r\n          </CCol>\r\n        </CRow>\r\n      </CContainer>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default SubmittedTimecards;\r\n","/*\n* FileSaver.js\n* A saveAs() FileSaver implementation.\n*\n* By Eli Grey, http://eligrey.com\n*\n* License : https://github.com/eligrey/FileSaver.js/blob/master/LICENSE.md (MIT)\n* source  : http://purl.eligrey.com/github/FileSaver.js\n*/\n\n// The one and only way of getting global scope in all environments\n// https://stackoverflow.com/q/3277182/1008999\nvar _global = typeof window === 'object' && window.window === window\n  ? window : typeof self === 'object' && self.self === self\n  ? self : typeof global === 'object' && global.global === global\n  ? global\n  : this\n\nfunction bom (blob, opts) {\n  if (typeof opts === 'undefined') opts = { autoBom: false }\n  else if (typeof opts !== 'object') {\n    console.warn('Deprecated: Expected third argument to be a object')\n    opts = { autoBom: !opts }\n  }\n\n  // prepend BOM for UTF-8 XML and text/* types (including HTML)\n  // note: your browser will automatically convert UTF-16 U+FEFF to EF BB BF\n  if (opts.autoBom && /^\\s*(?:text\\/\\S*|application\\/xml|\\S*\\/\\S*\\+xml)\\s*;.*charset\\s*=\\s*utf-8/i.test(blob.type)) {\n    return new Blob([String.fromCharCode(0xFEFF), blob], { type: blob.type })\n  }\n  return blob\n}\n\nfunction download (url, name, opts) {\n  var xhr = new XMLHttpRequest()\n  xhr.open('GET', url)\n  xhr.responseType = 'blob'\n  xhr.onload = function () {\n    saveAs(xhr.response, name, opts)\n  }\n  xhr.onerror = function () {\n    console.error('could not download file')\n  }\n  xhr.send()\n}\n\nfunction corsEnabled (url) {\n  var xhr = new XMLHttpRequest()\n  // use sync to avoid popup blocker\n  xhr.open('HEAD', url, false)\n  try {\n    xhr.send()\n  } catch (e) {}\n  return xhr.status >= 200 && xhr.status <= 299\n}\n\n// `a.click()` doesn't work for all browsers (#465)\nfunction click (node) {\n  try {\n    node.dispatchEvent(new MouseEvent('click'))\n  } catch (e) {\n    var evt = document.createEvent('MouseEvents')\n    evt.initMouseEvent('click', true, true, window, 0, 0, 0, 80,\n                          20, false, false, false, false, 0, null)\n    node.dispatchEvent(evt)\n  }\n}\n\n// Detect WebView inside a native macOS app by ruling out all browsers\n// We just need to check for 'Safari' because all other browsers (besides Firefox) include that too\n// https://www.whatismybrowser.com/guides/the-latest-user-agent/macos\nvar isMacOSWebView = _global.navigator && /Macintosh/.test(navigator.userAgent) && /AppleWebKit/.test(navigator.userAgent) && !/Safari/.test(navigator.userAgent)\n\nvar saveAs = _global.saveAs || (\n  // probably in some web worker\n  (typeof window !== 'object' || window !== _global)\n    ? function saveAs () { /* noop */ }\n\n  // Use download attribute first if possible (#193 Lumia mobile) unless this is a macOS WebView\n  : ('download' in HTMLAnchorElement.prototype && !isMacOSWebView)\n  ? function saveAs (blob, name, opts) {\n    var URL = _global.URL || _global.webkitURL\n    var a = document.createElement('a')\n    name = name || blob.name || 'download'\n\n    a.download = name\n    a.rel = 'noopener' // tabnabbing\n\n    // TODO: detect chrome extensions & packaged apps\n    // a.target = '_blank'\n\n    if (typeof blob === 'string') {\n      // Support regular links\n      a.href = blob\n      if (a.origin !== location.origin) {\n        corsEnabled(a.href)\n          ? download(blob, name, opts)\n          : click(a, a.target = '_blank')\n      } else {\n        click(a)\n      }\n    } else {\n      // Support blobs\n      a.href = URL.createObjectURL(blob)\n      setTimeout(function () { URL.revokeObjectURL(a.href) }, 4E4) // 40s\n      setTimeout(function () { click(a) }, 0)\n    }\n  }\n\n  // Use msSaveOrOpenBlob as a second approach\n  : 'msSaveOrOpenBlob' in navigator\n  ? function saveAs (blob, name, opts) {\n    name = name || blob.name || 'download'\n\n    if (typeof blob === 'string') {\n      if (corsEnabled(blob)) {\n        download(blob, name, opts)\n      } else {\n        var a = document.createElement('a')\n        a.href = blob\n        a.target = '_blank'\n        setTimeout(function () { click(a) })\n      }\n    } else {\n      navigator.msSaveOrOpenBlob(bom(blob, opts), name)\n    }\n  }\n\n  // Fallback to using FileReader and a popup\n  : function saveAs (blob, name, opts, popup) {\n    // Open a popup immediately do go around popup blocker\n    // Mostly only available on user interaction and the fileReader is async so...\n    popup = popup || open('', '_blank')\n    if (popup) {\n      popup.document.title =\n      popup.document.body.innerText = 'downloading...'\n    }\n\n    if (typeof blob === 'string') return download(blob, name, opts)\n\n    var force = blob.type === 'application/octet-stream'\n    var isSafari = /constructor/i.test(_global.HTMLElement) || _global.safari\n    var isChromeIOS = /CriOS\\/[\\d]+/.test(navigator.userAgent)\n\n    if ((isChromeIOS || (force && isSafari) || isMacOSWebView) && typeof FileReader !== 'undefined') {\n      // Safari doesn't allow downloading of blob URLs\n      var reader = new FileReader()\n      reader.onloadend = function () {\n        var url = reader.result\n        url = isChromeIOS ? url : url.replace(/^data:[^;]*;/, 'data:attachment/file;')\n        if (popup) popup.location.href = url\n        else location = url\n        popup = null // reverse-tabnabbing #460\n      }\n      reader.readAsDataURL(blob)\n    } else {\n      var URL = _global.URL || _global.webkitURL\n      var url = URL.createObjectURL(blob)\n      if (popup) popup.location = url\n      else location.href = url\n      popup = null // reverse-tabnabbing #460\n      setTimeout(function () { URL.revokeObjectURL(url) }, 4E4) // 40s\n    }\n  }\n)\n\n_global.saveAs = saveAs.saveAs = saveAs\n\nif (typeof module !== 'undefined') {\n  module.exports = saveAs;\n}\n"],"sourceRoot":""}