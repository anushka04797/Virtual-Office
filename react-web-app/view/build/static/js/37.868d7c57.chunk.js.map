{"version":3,"sources":["pages/holidays/holidaylist.js","../node_modules/lodash/orderBy.js"],"names":["Holidaylist","useState","setallHolidays","holidayData","setholidayData","excelData","setExcelData","a","ExcelJS","require","workbook","Workbook","sheet","addWorksheet","mergeCells","customcell","getCell","value","font","size","bold","alignment","horizontal","vertical","customcell1","length","getRow","values","name","family","height","columns","key","width","i","addRow","year","Year","title","holiday_title","start","start_date","end","end_date","hours","cell_num","xlsx","writeBuffer","buffer","blob","Blob","type","saveAs","useEffect","API","get","then","res","console","log","data","tableData","push","Hours","holidayTable","className","md","id","onClick","doc","jsPDF","setFontSize","uData","map","elt","idx","content","startY","head","body","text","autoTable","save","exportPdf","exoprtExcel","items","fields","primary","hover","striped","bordered","sorter","itemsPerPage","pagination","baseOrderBy","isArray","module","exports","collection","iteratees","orders","guard","undefined"],"mappings":"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","file":"static/js/37.868d7c57.chunk.js","sourcesContent":["import {\r\n  CContainer,\r\n  CRow,\r\n  CCol,\r\n  CForm,\r\n  CLabel,\r\n  CButton,\r\n  CDataTable,\r\n  CBadge,\r\n} from \"@coreui/react\";\r\nimport orderBy from \"lodash/orderBy\";\r\nimport React, { useState, useEffect } from \"react\";\r\n//import \"./timeCards.css\";\r\nimport Select from \"react-select\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { FILE_API, USER_ID } from \"../../Config\";\r\nimport { API } from \"../../Config\";\r\nimport { has_permission } from \"../../helper\";\r\nimport { useFormik } from \"formik\";\r\nimport jsPDF from \"jspdf\";\r\nimport \"jspdf-autotable\";\r\n\r\nimport CIcon from \"@coreui/icons-react\";\r\nimport moment from \"moment\";\r\nimport swal from \"sweetalert\";\r\n\r\nimport { saveAs } from \"file-saver\";\r\n//import AddTimecardItms from \"./addTimecardItem\";\r\n//import EditTimeCard from \"./Edit\";\r\nimport \"./holidays.css\";\r\nimport { useLocation } from \"react-router-dom\";\r\n\r\nconst Holidaylist = () => {\r\n  const [allholidays, setallHolidays] = useState([]);\r\n  const [holidayData, setholidayData] = useState([]);\r\n  const [excelData, setExcelData] = useState([])\r\n\r\n  const holidayTable = (data) => {\r\n    var tableData = [];\r\n    for (let i = 0; i < data.length; i++) {\r\n      tableData.push({\r\n        Year: data[i].Year,\r\n        \"Holiday Title\": data[i].holiday_title,\r\n        \"Start Date\": data[i].start_date,\r\n        \"End Date\": data[i].end_date,\r\n        Hours: data[i].hours,\r\n      });\r\n      console.log(\"table data \", tableData);\r\n    }\r\n    setholidayData(tableData);\r\n  };\r\n\r\n  async function exoprtExcel () {\r\n    \r\n    const ExcelJS = require(\"exceljs\");\r\n    const workbook = new ExcelJS.Workbook();\r\n    const sheet = workbook.addWorksheet(\"sheet1\");\r\n\r\n    sheet.mergeCells(\"B1:D2\");\r\n    const customcell = sheet.getCell(\"C1\");\r\n    customcell.value = \"Datasoft Manufacturing & Assembly\";\r\n    customcell.font = {\r\n      size: 15,\r\n      bold: true,\r\n    };\r\n    sheet.getCell(\"C1\").alignment = {\r\n      horizontal: \"center\",\r\n      vertical: \"center\",\r\n    };\r\n    sheet.mergeCells(\"B3:D3\");\r\n    const customcell1 = sheet.getCell(\"C3\");\r\n    customcell1.value = \"Gulshan Branch\";\r\n    customcell1.font = {\r\n      size: 13,\r\n      bold: true,\r\n    };\r\n    customcell1.alignment = {\r\n      horizontal: \"center\",\r\n      vertical: \"center\",\r\n    };\r\n\r\n    sheet.mergeCells(\"A5:B5\");\r\n    sheet.getCell(\"A5\").value = \"List of Holidays\";\r\n    sheet.getCell(\"A5\").font={\r\n      bold: true,\r\n    }\r\n    sheet.getCell(\"E5\").value = \"Total Holidays \"+excelData.length;\r\n    sheet.getCell(\"E5\").font={\r\n      bold: true,\r\n    }\r\n\r\n    sheet.mergeCells(\"F6:G6\");\r\n    \r\n\r\n    sheet.mergeCells(\"A6:D6\");\r\n\r\n    sheet.getRow(8).values = [\r\n      \"Year\",\r\n      \"Holiday Title\",\r\n      \"Start Date\",\r\n      \"End Date\",\r\n      \"Hours\",\r\n    ];\r\n    sheet.getRow(8).font = {\r\n      name: \"Arial Black\",\r\n      family: 3,\r\n\r\n      size: 10,\r\n    };\r\n\r\n    sheet.getRow(9).height = 20;\r\n    sheet.columns = [\r\n      { key: \"year\", width: 10 },\r\n      { key: \"title\", width: 30 },\r\n      { key: \"start\", width: 15 },\r\n      { key: \"end\", width: 15 },\r\n      { key: \"hours\", width: 15 },\r\n      \r\n    ];\r\n    \r\n    for (let i = 0; i < excelData.length; i++) {\r\n      sheet.addRow({\r\n        year: excelData[i].Year,\r\n        title: excelData[i].holiday_title,\r\n        start: excelData[i].start_date,\r\n        end: excelData[i].end_date,\r\n        hours: excelData[i].hours,\r\n      });\r\n    }\r\n\r\n\r\n    let cell_num = excelData.length + 12;\r\n    sheet.getRow(cell_num).values = [\r\n      \"\",\r\n      \"\",\r\n      \"\",\r\n      \"\",\r\n      \"Total Holidays = \" + excelData.length,\r\n    ];\r\n    sheet.getRow(cell_num).font={\r\n         bold: true\r\n    }\r\n    \r\n    const buffer = await workbook.xlsx.writeBuffer(excelData);\r\n    const fileType = \"application/octet-stream\";\r\n    const fileExtension = \".xlsx\";\r\n    const blob = new Blob([buffer], { type: fileType });\r\n    \r\n    const fileName = \"List-of-Holidays\"+fileExtension;\r\n    saveAs(blob, fileName);\r\n    \r\n\r\n\r\n\r\n  };\r\n\r\n\r\n\r\n  const exportPdf =()=>{\r\n    const unit = \"pt\";\r\n    const size = \"A4\"; // Use A1, A2, A3 or A4\r\n    const orientation = \"portrait\"; // portrait or landscape\r\n    const doc = new jsPDF(orientation, unit, size);\r\n    doc.setFontSize(15);\r\n\r\n    const headers = [[\r\n      \"Year\",\r\n      \"Holiday Title\",\r\n      \"Start Date\",\r\n      \"End Date\",\r\n      \"Hours\",\r\n    ],\r\n  ];\r\n  const uData = excelData.map((elt, idx) => [\r\n       \r\n    elt.Year,\r\n    elt.holiday_title,\r\n    elt.start_date,\r\n    elt.end_date,\r\n    elt.hours,\r\n])\r\nconsole.log(\"pdfData\", uData)\r\n  let content = {\r\n    startY: 140,\r\n    head: headers,\r\n    body: uData,\r\n};\r\n\r\n    doc.setFontSize(18);\r\n    doc.text(165, 50, \"Datasoft Manufacturing & Assembly\")\r\n    doc.setFontSize(14);\r\n    doc.text(230, 65,\"Gulshan Branch\")\r\n    doc.setFontSize(12);\r\n    doc.text(42,100, \"List of Holidays\")\r\n    doc.text(450, 100, \"Total Holidays \"+ excelData.length)\r\n    doc.autoTable(content);\r\n\r\n    \r\n    doc.save(\"List-of-Holidays.pdf\")\r\n  }\r\n  useEffect(() => {\r\n    API.get(\"organizations/holiday/all/\").then((res) => {\r\n      console.log(\"res\", res.data.data);\r\n      setallHolidays(res.data.data);\r\n      holidayTable(res.data.data);\r\n      setExcelData(res.data.data);\r\n    });\r\n    console.log(\"hello\");\r\n  }, []);\r\n\r\n  return (\r\n    <CContainer>\r\n      <CRow className=\"justify-content-between\">\r\n        <CCol md=\"12\">\r\n          <CRow className=\"justify-content-between\">\r\n            <CCol>\r\n              <h3 className=\"timecards-page-header mb-3\">List of Holidays</h3>\r\n            </CCol>\r\n            <CCol md=\"8\" id=\"tableRef\" className=\"d-flex justify-content-end\">\r\n              <h5 className=\"tiny-header--5 mt-3 mr-2\">Export </h5>\r\n              <div className=\"format-buttons mt-3 mb-3 \">\r\n                <CButton\r\n                  className=\"file-format-download\"\r\n                  onClick={() => exportPdf()}\r\n                >\r\n                  <CIcon name=\"cil-description\" className=\"mr-2\" /> PDF\r\n                </CButton>\r\n                <CButton\r\n                  className=\"file-format-download\"\r\n                  onClick={\r\n                    () => exoprtExcel()\r\n                    //exportToCSV(usersData, \"Timecard of\" + \" \" + pdfTitle)\r\n                  }\r\n                >\r\n                  <CIcon name=\"cil-spreadsheet\" className=\"mr-2\" />\r\n                  Excel\r\n                </CButton>\r\n                {/* <CButton className=\"file-format-download\">Print</CButton> */}\r\n              </div>\r\n            </CCol>\r\n          </CRow>\r\n          <CDataTable\r\n            items={holidayData}\r\n            fields={[\r\n              \"Year\",\r\n              \"Holiday Title\",\r\n              \"Start Date\",\r\n              \"End Date\",\r\n              \"Hours\",\r\n            ]}\r\n            primary\r\n            hover\r\n            striped\r\n            bordered\r\n            sorter\r\n            //columnFilter\r\n            size=\"sm\"\r\n            itemsPerPage={20}\r\n            pagination\r\n          />\r\n        </CCol>\r\n      </CRow>\r\n      <CRow className=\"justify-content-end mb-5\">\r\n        <CCol md=\"2\" className=\"justify-content-end tiny-header--5\">\r\n          Total Holidays {holidayData.length}\r\n        </CCol>\r\n      </CRow>\r\n    </CContainer>\r\n  );\r\n};\r\n\r\nexport default Holidaylist;\r\n","var baseOrderBy = require('./_baseOrderBy'),\n    isArray = require('./isArray');\n\n/**\n * This method is like `_.sortBy` except that it allows specifying the sort\n * orders of the iteratees to sort by. If `orders` is unspecified, all values\n * are sorted in ascending order. Otherwise, specify an order of \"desc\" for\n * descending or \"asc\" for ascending sort order of corresponding values.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Collection\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Array[]|Function[]|Object[]|string[]} [iteratees=[_.identity]]\n *  The iteratees to sort by.\n * @param {string[]} [orders] The sort orders of `iteratees`.\n * @param- {Object} [guard] Enables use as an iteratee for methods like `_.reduce`.\n * @returns {Array} Returns the new sorted array.\n * @example\n *\n * var users = [\n *   { 'user': 'fred',   'age': 48 },\n *   { 'user': 'barney', 'age': 34 },\n *   { 'user': 'fred',   'age': 40 },\n *   { 'user': 'barney', 'age': 36 }\n * ];\n *\n * // Sort by `user` in ascending order and by `age` in descending order.\n * _.orderBy(users, ['user', 'age'], ['asc', 'desc']);\n * // => objects for [['barney', 36], ['barney', 34], ['fred', 48], ['fred', 40]]\n */\nfunction orderBy(collection, iteratees, orders, guard) {\n  if (collection == null) {\n    return [];\n  }\n  if (!isArray(iteratees)) {\n    iteratees = iteratees == null ? [] : [iteratees];\n  }\n  orders = guard ? undefined : orders;\n  if (!isArray(orders)) {\n    orders = orders == null ? [] : [orders];\n  }\n  return baseOrderBy(collection, iteratees, orders);\n}\n\nmodule.exports = orderBy;\n"],"sourceRoot":""}