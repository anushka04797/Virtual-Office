(this.webpackJsonpvirtual_office=this.webpackJsonpvirtual_office||[]).push([[37],{1181:function(e,t,a){"use strict";a.r(t);var l=a(6),s=a(9),n=a(31),o=a(492),i=(a(798),a(0)),r=(a(93),a(8)),c=(a(505),a(528),a(638)),d=(a(670),a(510)),u=(a(69),a(512),a(536)),f=(a(1182),a(5));t.default=function(){var e=Object(i.useState)([]),t=Object(n.a)(e,2),h=(t[0],t[1]),m=Object(i.useState)([]),b=Object(n.a)(m,2),j=b[0],y=b[1],g=Object(i.useState)([]),x=Object(n.a)(g,2),p=x[0],O=x[1];function v(){return(v=Object(s.a)(Object(l.a)().mark((function e(){var t,s,n,o,i,r,c,d,f;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=a(774),s=new t.Workbook,(n=s.addWorksheet("sheet1")).mergeCells("B1:D2"),(o=n.getCell("C1")).value="Datasoft Manufacturing & Assembly",o.font={size:15,bold:!0},n.getCell("C1").alignment={horizontal:"center",vertical:"center"},n.mergeCells("B3:D3"),(i=n.getCell("C3")).value="Gulshan Branch",i.font={size:13,bold:!0},i.alignment={horizontal:"center",vertical:"center"},n.mergeCells("A5:B5"),n.getCell("A5").value="List of Holidays",n.getCell("A5").font={bold:!0},n.getCell("E5").value="Total Holidays "+p.length,n.getCell("E5").font={bold:!0},n.mergeCells("F6:G6"),n.mergeCells("A6:D6"),n.getRow(8).values=["Year","Holiday Title","Start Date","End Date","Hours"],n.getRow(8).font={name:"Arial Black",family:3,size:10},n.getRow(9).height=20,n.columns=[{key:"year",width:10},{key:"title",width:30},{key:"start",width:15},{key:"end",width:15},{key:"hours",width:15}],r=0;r<p.length;r++)n.addRow({year:p[r].Year,title:p[r].holiday_title,start:p[r].start_date,end:p[r].end_date,hours:p[r].hours});return c=p.length+12,n.getRow(c).values=["","","","","Total Holidays = "+p.length],n.getRow(c).font={bold:!0},e.next=30,s.xlsx.writeBuffer(p);case 30:d=e.sent,"application/octet-stream",".xlsx",f=new Blob([d],{type:"application/octet-stream"}),"List-of-Holidays.xlsx",Object(u.saveAs)(f,"List-of-Holidays.xlsx");case 36:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(i.useEffect)((function(){r.a.get("organizations/holiday/all/").then((function(e){console.log("res",e.data.data),h(e.data.data),function(e){for(var t=[],a=0;a<e.length;a++)t.push({Year:e[a].Year,"Holiday Title":e[a].holiday_title,"Start Date":e[a].start_date,"End Date":e[a].end_date,Hours:e[a].hours}),console.log("table data ",t);y(t)}(e.data.data),O(e.data.data)})),console.log("hello")}),[]),Object(f.jsxs)(o.l,{children:[Object(f.jsx)(o.K,{className:"justify-content-between",children:Object(f.jsxs)(o.k,{md:"12",children:[Object(f.jsxs)(o.K,{className:"justify-content-between",children:[Object(f.jsx)(o.k,{children:Object(f.jsx)("h3",{className:"timecards-page-header mb-3",children:"List of Holidays"})}),Object(f.jsxs)(o.k,{md:"8",id:"tableRef",className:"d-flex justify-content-end",children:[Object(f.jsx)("h5",{className:"tiny-header--5 mt-3 mr-2",children:"Export "}),Object(f.jsxs)("div",{className:"format-buttons mt-3 mb-3 ",children:[Object(f.jsxs)(o.f,{className:"file-format-download",onClick:function(){return function(){var e=new c.default("portrait","pt","A4");e.setFontSize(15);var t=p.map((function(e,t){return[e.Year,e.holiday_title,e.start_date,e.end_date,e.hours]}));console.log("pdfData",t);var a={startY:140,head:[["Year","Holiday Title","Start Date","End Date","Hours"]],body:t};e.setFontSize(18),e.text(165,50,"Datasoft Manufacturing & Assembly"),e.setFontSize(14),e.text(230,65,"Gulshan Branch"),e.setFontSize(12),e.text(42,100,"List of Holidays"),e.text(450,100,"Total Holidays "+p.length),e.autoTable(a),e.save("List-of-Holidays.pdf")}()},children:[Object(f.jsx)(d.a,{name:"cil-description",className:"mr-2"})," PDF"]}),Object(f.jsxs)(o.f,{className:"file-format-download",onClick:function(){return function(){return v.apply(this,arguments)}()},children:[Object(f.jsx)(d.a,{name:"cil-spreadsheet",className:"mr-2"}),"Excel"]})]})]})]}),Object(f.jsx)(o.m,{items:j,fields:["Year","Holiday Title","Start Date","End Date","Hours"],primary:!0,hover:!0,striped:!0,bordered:!0,sorter:!0,size:"sm",itemsPerPage:20,pagination:!0})]})}),Object(f.jsx)(o.K,{className:"justify-content-end mb-5",children:Object(f.jsxs)(o.k,{md:"2",className:"justify-content-end tiny-header--5",children:["Total Holidays ",j.length]})})]})}},1182:function(e,t,a){},798:function(e,t,a){var l=a(170),s=a(25);e.exports=function(e,t,a,n){return null==e?[]:(s(t)||(t=null==t?[]:[t]),s(a=n?void 0:a)||(a=null==a?[]:[a]),l(e,t,a))}}}]);
//# sourceMappingURL=37.02266a98.chunk.js.map