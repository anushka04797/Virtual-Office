(this.webpackJsonpvirtual_office=this.webpackJsonpvirtual_office||[]).push([[32],{506:function(e,t){},528:function(e,t){},529:function(e,t){},646:function(e,t,a){},999:function(e,t,a){"use strict";a.r(t);var s=a(19),n=a(33),d=a(0),c=a.n(d),r=(a(646),a(514)),o=a(8),u=a(95),i=a(629),l=(a(715),a(518)),y=a(519),m=a(495),j=a(72),f=a.n(j),b=a(490),h=a(99),p=a(3);t.default=function(){var e=Object(u.c)((function(e){return e.profile.data})),t=Object(d.useState)([]),a=Object(n.a)(t,2),j=a[0],_=a[1],O=[],x=Object(d.useState)([]),T=Object(n.a)(x,2),S=T[0],Y=T[1],k=Object(d.useState)(),w=Object(n.a)(k,2),v=(w[0],w[1],Object(d.useState)()),g=Object(n.a)(v,2),M=g[0],N=g[1],W=Object(d.useState)(),D=Object(n.a)(W,2),F=D[0],B=D[1],P=Object(d.useState)([]),V=Object(n.a)(P,2),E=V[0],C=V[1],R=Object(d.useState)([]),A=Object(n.a)(R,2),z=(A[0],A[1]),H=Object(d.useState)(0),J=Object(n.a)(H,2),q=J[0],I=J[1],K=Object(d.useState)(!1),U=Object(n.a)(K,2),G=(U[0],U[1],[]),L=Object(h.b)(),Q=L.enqueueSnackbar;L.closeSnackbar;function X(){o.a.get("wbs/user-wise/weekly-time-card/"+sessionStorage.getItem(o.j)+"/").then((function(e){if(N(e.data.start_date),B(e.data.end_date),void 0!=e.data.data&&e.data.data.forEach((function(e,t){G.push(e.project.sub_task);var a={id:e.id,project:e.project,time_card_assignee:e.time_card_assignee,actual_work_done:e.actual_work_done,time_type:e.time_type,submitted:e.submitted,hours_today:e.hours_today,date_created:e.date_created,date_updated:e.date_updated};O.push(a)})),console.log(G),console.log("new array",O),Y(O),0!=O.length||void 0!=O){for(var t=[],a=0,s=0;s<O.length;s++){var n=O[s];a+=parseFloat(n.hours_today),console.log("ddddddddd",n.project.work_package_number);var d=f()(n.date_updated).weekday();t.push({WP:n.project.work_package_number,id:n.id,WBS:n.actual_work_done,Time:n.time_type,Sunday:0==d?n.hours_today:"",Monday:1==d?n.hours_today:"",Tuesday:2==d?n.hours_today:"",Wednesday:3==d?n.hours_today:"",Thursday:4==d?n.hours_today:"",Friday:5==d?n.hours_today:"",Saturday:6==d?n.hours_today:"",Total:n.hours_today}),console.log(f()(n.date_updated).weekday())}t.push({WP:"",id:"",WBS:"",Time:"",Sunday:"",Monday:"",Tuesday:"",Wednesday:"",Thursday:"",Friday:"",Saturday:"",Total:"Total = "+a.toFixed(1)}),_(t),z(t),I(a.toFixed(1)),console.log("tabledata from weekly timecard",q)}}))}c.a.useEffect((function(){window.scrollTo(0,0),X()}),[]),c.a.useEffect((function(){C(G)}),[]);Object(r.a)({initialValues:{wbs:"",time:"",hrs:""},validateOnBlur:!0,validateOnChange:!0});var Z=[{value:"RHR",label:"RHR"},{value:"OTO",label:"OTO"}];function $(e,t){console.log(e.target.value,t);var a={time_type:t.Time,hours_today:e.target.value,date_updated:""};o.a.put("wbs/time-card/update/"+t.id+"/",a).then((function(e){console.log(e),200===e.status&&(X(),Q("Actual hours update succefull.",{variant:"info"}))}))}return Object(p.jsx)(p.Fragment,{children:Object(p.jsxs)(b.l,{children:[Object(p.jsx)("h3",{className:"timecards-page-header mb-3",children:"Weekly Timecard"}),Object(p.jsxs)(b.K,{children:[0!=j.length&&Object(p.jsxs)(b.k,{md:"12",children:[Object(p.jsx)("h5",{className:"tiny-header--5 mt-0",children:"Export"}),Object(p.jsxs)("div",{className:"format-buttons mt-3 mb-3",children:[Object(p.jsxs)(b.f,{className:"file-format-download",onClick:function(){return function(){var t=new i.default("landscape","pt","A4");t.setFontSize(12);var a=e.first_name+"_"+e.last_name+"_Timecard_"+f()(M).format("DD/MM/YYYY")+"-"+f()(F).format("DD/MM/YYYY");console.log("pdfData",S);var s={startY:50,head:[["WP","WBS","Time","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Total"]],body:j.map((function(e,t){return[e.WP,e.WBS,e.Time,e.Sunday,e.Monday,e.Tuesday,e.Wednesday,e.Thursday,e.Friday,e.Saturday,e.Total]}))};t.text(a,40,30),t.autoTable(s),t.save(e.first_name+"_"+e.last_name+"_Timecard_"+f()(M).format("DD/MM/YYYY")+"-"+f()(F).format("DD/MM/YYYY")+".pdf")}()},children:[Object(p.jsx)(m.a,{name:"cil-description",className:"mr-2"}),"PDF"]}),Object(p.jsxs)(b.f,{className:"file-format-download",onClick:function(){return function(e,t){console.log(e);var a={Sheets:{data:y.utils.json_to_sheet(e)},SheetNames:["data"]},s=y.write(a,{bookType:"xlsx",type:"array"}),n=new Blob([s],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});l.saveAs(n,t+".xlsx")}(j,e.first_name+"_"+e.last_name+"_Timecard_"+f()(M).format("DD/MM/YYYY")+"-"+f()(F).format("DD/MM/YYYY"))},children:[Object(p.jsx)(m.a,{name:"cil-spreadsheet",className:"mr-2"}),"Excel"]})]})]}),Object(p.jsxs)(b.k,{md:"4",children:["Name: ",e.first_name+" "+e.last_name,Object(p.jsx)("br",{}),"Phone: +",e.phone]}),Object(p.jsxs)(b.k,{md:"4",children:["Week: ",f()(M).format("DD/MM/YYYY")," - ",f()(F).format("DD/MM/YYYY")," ",Object(p.jsx)("br",{}),"Month: ",f()(F).format("MMMM")," ",Object(p.jsx)("br",{}),"Year: ",f()(F).format("YYYY")]}),Object(p.jsxs)(b.k,{md:"4",children:["Project Name(s): ",Object(s.a)(new Set(E)).map((function(e,t){return Object(p.jsxs)("span",{children:[e,t<E.length-1&&Object(p.jsx)("span",{children:", "})]})}))]}),Object(p.jsx)(b.k,{md:"12",children:Object(p.jsx)("div",{className:"mt-4 mb-2",children:Object(p.jsx)(b.m,{items:j,fields:[{key:"WP",_style:{width:"auto"},_classes:"font-weight-bold"},"WBS",{key:"Time",_style:{width:"100px"}},{key:"Sunday",_style:{width:"70px"}},{key:"Monday",_style:{width:"70px"}},{key:"Tuesday",_style:{width:"70px"}},{key:"Wednesday",_style:{width:"70px"}},{key:"Thursday",_style:{width:"70px"}},{key:"Friday",_style:{width:"70px"}},{key:"Saturday",_style:{width:"70px"}},{key:"Total",_style:{width:"auto"}}],primary:!0,hover:!0,striped:!0,bordered:!0,size:"sm",scopedSlots:{Time:function(e,t){return Object(p.jsx)("td",{className:"py-2",children:""!=e.Time&&Object(p.jsx)("select",{onChange:function(t){!function(e,t){console.log(e.target.value,t);var a={time_type:e.target.value,hours_today:t.Total,date_updated:""};o.a.put("wbs/time-card/update/"+t.id+"/",a).then((function(e){console.log(e),200===e.status&&(X(),Q("Time type update succefull.",{variant:"info"}))}))}(t,e)},children:Z.map((function(t){return Object(p.jsx)("option",{selected:t.value==e.Time,children:t.value})}))})})},Sunday:function(e,t){return Object(p.jsx)("td",{className:"py-2",children:""!=e.Sunday&&Object(p.jsx)(b.y,{name:"Sunday",type:"number",onBlur:function(t){$(t,e)},defaultValue:e.Sunday,className:"custom-forminput-6"})})},Monday:function(e,t){return Object(p.jsx)("td",{className:"py-2",children:""!=e.Monday&&Object(p.jsx)(b.y,{name:"Monday",type:"number",onBlur:function(t){$(t,e)},defaultValue:e.Monday,className:"custom-forminput-6"})})},Tuesday:function(e,t){return Object(p.jsx)("td",{className:"py-2",children:""!=e.Tuesday&&Object(p.jsx)(b.y,{name:"Tuesday",type:"number",onBlur:function(t){$(t,e)},defaultValue:e.Tuesday,className:"custom-forminput-6"})})},Wednesday:function(e,t){return Object(p.jsx)("td",{className:"py-2",children:""!=e.Wednesday&&Object(p.jsx)(b.y,{name:"Wednesday",type:"number",onBlur:function(t){$(t,e)},defaultValue:e.Wednesday,className:"custom-forminput-6"})})},Thursday:function(e,t){return Object(p.jsx)("td",{className:"py-2",children:""!=e.Thursday&&Object(p.jsx)(b.y,{name:"Thursday",type:"number",onBlur:function(t){$(t,e)},defaultValue:e.Thursday,className:"custom-forminput-6"})})},Friday:function(e,t){return Object(p.jsx)("td",{className:"py-2",children:""!=e.Friday&&Object(p.jsx)(b.y,{name:"Friday",type:"number",onBlur:function(t){$(t,e)},defaultValue:e.Friday,className:"custom-forminput-6"})})},Saturday:function(e,t){return Object(p.jsx)("td",{className:"py-2",children:""!=e.Saturday&&Object(p.jsx)(b.y,{name:"Saturday",type:"number",onBlur:function(t){$(t,e)},defaultValue:e.Saturday,className:"custom-forminput-6"})})}}})})})]})]})})}}}]);
//# sourceMappingURL=32.d0cb62bd.chunk.js.map