(this.webpackJsonpvirtual_office=this.webpackJsonpvirtual_office||[]).push([[37],{1186:function(e,t,a){"use strict";a.r(t);var s=a(9),l=a(30),n=a(6),o=a.n(n),r=a(490),i=(a(794),a(0)),c=(a(91),a(8)),d=(a(501),a(522),a(633)),u=(a(663),a(505)),f=(a(68),a(507),a(530)),h=(a(1187),a(5));t.default=function(){var e=Object(i.useState)([]),t=Object(l.a)(e,2),n=(t[0],t[1]),m=Object(i.useState)([]),b=Object(l.a)(m,2),j=b[0],y=b[1],g=Object(i.useState)([]),x=Object(l.a)(g,2),p=x[0],O=x[1];function v(){return(v=Object(s.a)(o.a.mark((function e(){var t,s,l,n,r,i,c,d;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=a(770),s=new t.Workbook,(l=s.addWorksheet("sheet1")).mergeCells("B1:D2"),(n=l.getCell("C1")).value="Datasoft Manufacturing & Assembly",n.font={size:15,bold:!0},l.getCell("C1").alignment={horizontal:"center",vertical:"center"},l.mergeCells("B3:D3"),(r=l.getCell("C3")).value="Gulshan Branch",r.font={size:13,bold:!0},r.alignment={horizontal:"center",vertical:"center"},l.mergeCells("A5:B5"),l.getCell("A5").value="List of Holidays",l.getCell("A5").font={bold:!0},l.getCell("E5").value="Total Holidays "+p.length,l.getCell("E5").font={bold:!0},l.mergeCells("F6:G6"),l.mergeCells("A6:D6"),l.getRow(8).values=["Year","Holiday Title","Start Date","End Date","Hours"],l.getRow(8).font={name:"Arial Black",family:3,size:10},l.getRow(9).height=20,l.columns=[{key:"year",width:10},{key:"title",width:30},{key:"start",width:15},{key:"end",width:15},{key:"hours",width:15}],i=0;i<p.length;i++)l.addRow({year:p[i].Year,title:p[i].holiday_title,start:p[i].start_date,end:p[i].end_date,hours:p[i].hours});return e.next=27,s.xlsx.writeBuffer(p);case 27:c=e.sent,"application/octet-stream",".xlsx",d=new Blob([c],{type:"application/octet-stream"}),"List-of-Holidays.xlsx",Object(f.saveAs)(d,"List-of-Holidays.xlsx");case 33:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(i.useEffect)((function(){c.a.get("organizations/holiday/all/").then((function(e){console.log("res",e.data.data),n(e.data.data),function(e){for(var t=[],a=0;a<e.length;a++)t.push({Year:e[a].Year,"Holiday Title":e[a].holiday_title,"Start Date":e[a].start_date,"End Date":e[a].end_date,Hours:e[a].hours}),console.log("table data ",t);y(t)}(e.data.data),O(e.data.data)})),console.log("hello")}),[]),Object(h.jsxs)(r.l,{children:[Object(h.jsx)(r.K,{className:"justify-content-between",children:Object(h.jsxs)(r.k,{md:"12",children:[Object(h.jsxs)(r.K,{className:"justify-content-between",children:[Object(h.jsx)(r.k,{children:Object(h.jsx)("h3",{className:"timecards-page-header mb-3",children:"List of Holidays"})}),Object(h.jsxs)(r.k,{md:"8",id:"tableRef",className:"d-flex justify-content-end",children:[Object(h.jsx)("h5",{className:"tiny-header--5 mt-3 mr-2",children:"Export "}),Object(h.jsxs)("div",{className:"format-buttons mt-3 mb-3 ",children:[Object(h.jsxs)(r.f,{className:"file-format-download",onClick:function(){return function(){var e=new d.default("portrait","pt","A4");e.setFontSize(15);var t=p.map((function(e,t){return[e.Year,e.holiday_title,e.start_date,e.end_date,e.hours]}));console.log("pdfData",t);var a={startY:140,head:[["Year","Holiday Title","Start Date","End Date","Hours"]],body:t};e.setFontSize(18),e.text(165,50,"Datasoft Manufacturing & Assembly"),e.setFontSize(14),e.text(230,65,"Gulshan Branch"),e.setFontSize(12),e.text(42,100,"List of Holidays"),e.text(450,100,"Total Holidays "+p.length),e.autoTable(a),e.save("List-of-Holidays.pdf")}()},children:[Object(h.jsx)(u.a,{name:"cil-description",className:"mr-2"})," PDF"]}),Object(h.jsxs)(r.f,{className:"file-format-download",onClick:function(){return function(){return v.apply(this,arguments)}()},children:[Object(h.jsx)(u.a,{name:"cil-spreadsheet",className:"mr-2"}),"Excel"]})]})]})]}),Object(h.jsx)(r.m,{items:j,fields:["Year","Holiday Title","Start Date","End Date","Hours"],primary:!0,hover:!0,striped:!0,bordered:!0,sorter:!0,size:"sm",itemsPerPage:20,pagination:!0})]})}),Object(h.jsx)(r.K,{className:"justify-content-end mb-5",children:Object(h.jsxs)(r.k,{md:"2",className:"justify-content-end tiny-header--5",children:["Total Holidays ",j.length]})})]})}},1187:function(e,t,a){},794:function(e,t,a){var s=a(168),l=a(24);e.exports=function(e,t,a,n){return null==e?[]:(l(t)||(t=null==t?[]:[t]),l(a=n?void 0:a)||(a=null==a?[]:[a]),s(e,t,a))}}}]);
//# sourceMappingURL=37.e164a452.chunk.js.map