(this.webpackJsonpvirtual_office=this.webpackJsonpvirtual_office||[]).push([[31],{1437:function(e,t,a){"use strict";a.r(t);var n=a(6),r=a(2),s=a(9),l=a(31),o=a(492),c=a(615),i=a.n(c),d=a(510),u=a(0),m=a.n(u),f=a(94),b=(a(72),a(505)),O=a(69),h=a.n(O),j=(a(625),a(106)),g=a(654),p=(a(680),a(540)),y=a(8),x=a(512),k=a(5);t.default=function(){var e=Object(f.b)(),t=Object(u.useState)([]),c=Object(l.a)(t,2),O=c[0],C=c[1],S=Object(u.useState)(),v=Object(l.a)(S,2),M=v[0],w=v[1],H=Object(u.useState)(),_=Object(l.a)(H,2),T=(_[0],_[1],Object(u.useState)([])),R=Object(l.a)(T,2),B=R[0],Y=R[1],P=[],W=Object(f.c)((function(e){return e.profile.data})),N=Object(f.c)((function(e){var t=[];return Array.from(e.timecardList.user_weekly_submitted_timecards).forEach((function(e,a){t.push({id:e.employee.id,data:e.employee,Weekending:h()(e.week_end).format("ddd, MMMM DD, YYYY"),Name:e.employee.first_name+" "+e.employee.last_name,Total:e.total_hours,RHR:null==e.RHR?"-":e.RHR,SIC:null==e.SIC?"-":e.SIC,HOL:null==e.HOL?"-":e.HOL,WFH:null==e.WFH?"-":e.WFH,OTO:null==e.OTO?"-":e.OTO,VAC:null==e.VAC?"-":e.VAC,COM:null==e.COM?"-":e.COM,PB1:null==e.PB1?"-":e.PB1,PB2:null==e.PB2?"-":e.PB2,Submitted:h()(e.submitted_at).format("ddd, MMMM DD, YYYY")+" at "+h()(e.submitted_at).format("h:mm")})})),P=[].concat(t),t})),D=Object(u.useState)([]),A=Object(l.a)(D,2),F=A[0],L=A[1],I=Object(f.c)((function(e){var t=[];return Array.from(e.timecardList.user_weekly_submitted_timecards).forEach((function(e,a){t.push({data:e,label:h()(e.week_end).format("ddd, MMMM DD, YYYY"),value:h()(e.week_end).format("ddd, MMMM DD, YYYY")})})),i()(t,"label")})),V=function(){return"undefined"==M||null==M?(i()(N,"Name"),N):(i()(F,"Name"),F)};m.a.useEffect((function(){e(Object(j.e)()),y.a.get("auth/assignee/list/").then((function(e){console.log("assignees",e.data.data);var t=[];Array.from(e.data.data).forEach((function(e,a){""!=e.first_name&&t.push({value:e.id,label:e.first_name+" "+e.last_name,data:e})})),console.log("all assignees",t.length),C(t.length)}))}),[]);function z(){return(z=Object(s.a)(Object(n.a)().mark((function e(){var t,s,l,o,c,i,d,u,m,f,b,O,j,g,y,x,k;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a(782),s=new t.Workbook,(l=s.addWorksheet("sheet1")).mergeCells("B1:F2"),(o=l.getCell("C1")).value="Datasoft Manufacturing & Assembly",o.font={size:15,bold:!0},l.getCell("C1").alignment={horizontal:"center",vertical:"center"},l.mergeCells("C3:D3"),(c=l.getCell("C3")).value="Gulshan Branch",c.font={size:13,bold:!0},c.alignment={horizontal:"center",vertical:"center"},l.mergeCells("A5:B5"),l.getCell("A5").value="Submitted Timecards",l.getRow(8).values=["Weekending","Name","Total","RHR","SIC","HOL","PB1","PB2","WFH","OTO","VAC","COM","Submitted"],l.getRow(8).font={name:"Arial Black",family:3,size:9},l.getRow(8).height=20,l.columns=[{key:"Weekending",width:20},{key:"Name",width:25},{key:"Total",width:10},{key:"RHR",width:10},{key:"SIC",width:10},{key:"HOL",width:10},{key:"PB1",width:10},{key:"PB2",width:10},{key:"WFH",width:10},{key:"OTO",width:10},{key:"VAC",width:10},{key:"COM",width:10},{key:"Submitted",width:20}],console.log("submitted",P),"undefined"==M||null==M){for(i=0;i<N.length;i++)l.addRow((d={Weekending:N[i].Weekending,Name:N[i].Name,Total:N[i].Total,RHR:N[i].RHR,SIC:N[i].SIC,HOL:N[i].HOL,PB1:N[i].PB1},Object(r.a)(d,"PB1",N[i].PB2),Object(r.a)(d,"WFH",N[i].WFH),Object(r.a)(d,"OTO",N[i].OTO),Object(r.a)(d,"VAC",N[i].VAC),Object(r.a)(d,"COM",N[i].COM),Object(r.a)(d,"Submitted",N[i].Submitted),d));u=N.length+11,0!=N.length&&(l.getRow(u).values=["Total Submitted =  "+N.length])}else{for(m=0;m<B.length;m++)l.addRow({Weekending:B[m].Weekending,Name:B[m].Name,Total:B[m].Total,RHR:B[m].RHR,SIC:B[m].SIC,HOL:B[m].HOL,PB1:B[m].PB1,PB2:B[m].PB2,WFH:B[m].WFH,OTO:B[m].OTO,VAC:B[m].VAC,COM:B[m].COM,Submitted:B[m].Submitted});f=B.length+11,0!=B.length&&(l.getRow(f).values=["Total Submitted =  "+B.length])}return e.next=23,s.xlsx.writeBuffer();case 23:b=e.sent,"application/octet-stream",".xlsx",O=new Blob([b],{type:"application/octet-stream"}),j=W.first_name+"_"+W.last_name,g=new Date,y=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][g.getDay()],x=h()(g).format("DD-MM-YYYY"),k=j+"_"+y+"_"+x+"_.xlsx",Object(p.saveAs)(O,k);case 34:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var E=Object(u.useState)(""),K=Object(l.a)(E,2),G=(K[0],K[1],Object(u.useState)("")),J=Object(l.a)(G,2),q=(J[0],J[1],Object(u.useState)(0)),Q=Object(l.a)(q,2);Q[0],Q[1];return Object(k.jsx)(k.Fragment,{children:Object(k.jsxs)(o.l,{children:[Object(k.jsxs)(o.K,{children:[Object(k.jsx)(o.k,{children:Object(k.jsx)("h3",{className:"timecards-page-header mb-3",children:"Submitted Timecards"})}),Object(k.jsxs)(o.k,{md:"8",id:"tableRef",className:"d-flex justify-content-end",children:[Object(k.jsx)("h5",{className:"tiny-header--5 mt-3 mr-2",children:"Export "}),Object(k.jsxs)("div",{className:"format-buttons mt-3 mb-3 ",children:[Object(k.jsxs)(o.f,{className:"file-format-download",onClick:function(){!function(){var e=W.first_name+"_"+W.last_name,t=new g.default("portrait","pt","A4");t.setFontSize(15);var a=[];"undefined"==M||null==M?(Y(N),console.log("submitted tcs",N),a=N.map((function(e,t){return[e.Weekending,e.Name,e.Total,e.RHR,e.SIC,e.HOL,e.PB1,e.PB2,e.WFH,e.OTO,e.VAC,e.COM,e.Submitted,console.log("data",e)]}))):a=B.map((function(e,t){return[e.Weekending,e.Name,e.Total,e.RHR,e.SIC,e.HOL,e.PB1,e.PB2,e.WFH,e.OTO,e.VAC,e.COM,e.Submitted,console.log("data",e)]}));var n={startY:145,head:[["Weekending","Name","Total","RHR","SIC","HOL","PB1","PB2","WFH","OTO","VAC","COM","Submitted"]],body:a},r=new Date,s=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][r.getDay()],l=h()(r).format("DD-MM-YYYY");console.log("days ",l),t.text(170,50,"Datasoft Manufacturing & Assembly"),t.setFontSize(13),t.text(245,75,"Gulshan Branch"),t.setFontSize(11),t.text(42,105,"Submitted Time Cards"),Object(b.g)("projects.add_projects")||t.text(42,125,"Employee Name: "+e),t.text(440,360,"Total "+P.length+" Submitted"),t.autoTable(n),t.save(e+"_"+s+"_"+l+"_.pdf")}()},children:[Object(k.jsx)(d.a,{name:"cil-description",className:"mr-2"})," PDF"]}),Object(k.jsxs)(o.f,{className:"file-format-download",onClick:function(){!function(){z.apply(this,arguments)}()},children:[Object(k.jsx)(d.a,{name:"cil-spreadsheet",className:"mr-2"}),"Excel"]})]})]})]}),Object(k.jsx)(o.K,{children:Object(k.jsx)(o.k,{xl:"3",lg:"3",md:"6",children:Object(k.jsxs)("div",{children:[Object(k.jsx)(o.z,{className:"custom-label-5",htmlFor:"assigneeSelectPM",children:"Select Weekending"}),Object(k.jsx)(x.a,{closeMenuOnSelect:!0,placeholder:"",id:"assigneeSelectPM",minHeight:"35px",isClearable:!0,isMulti:!1,onChange:function(e,t){w(e);var a=[];if("select-option"==t.action){a=[],console.log("select");for(var n=0;n<N.length;n++)e.value==N[n].Weekending&&a.push(N[n])}else if("clear"==t.action){console.log("clear");for(var r=0;r<N.length;r++)a.push(N[r])}console.log("filtered",a),L(a),Y(a)},classNamePrefix:"custom-forminput-6",options:I,value:M})]})})}),Object(k.jsx)(o.K,{children:!Object(b.g)("projects.add_projects")&&Object(k.jsx)(o.k,{})}),Object(k.jsx)(o.K,{className:"mt-5",children:Object(k.jsxs)(o.k,{children:[Object(k.jsx)(o.m,{items:V(),fields:[{key:"Weekending",_style:{width:"15%"},_classes:"font-weight-bold"},"Name","Total",{key:"RHR",sorter:!1},{key:"SIC",sorter:!1},{key:"HOL",sorter:!1},{key:"PB1",sorter:!1},{key:"PB2",sorter:!1},{key:"WFH",sorter:!1},{key:"OTO",sorter:!1},{key:"VAC",sorter:!1},{key:"COM",sorter:!1},{key:"Submitted",sorter:!1}],itemsPerPage:10,pagination:!0,striped:!0,bordered:!0,sorter:!0,scopedSlots:{Name:function(e){return Object(k.jsx)("td",{children:Object(k.jsx)("a",{onClick:function(){!function(e){var t=h()(e.Weekending).format("YYYY-MM-DD"),a=h()(e.Weekending).subtract(6,"day").toDate();a=h()(a).format("YYYY-MM-DD");var n=e.id,r=e.Name;y.a.get("wbs/user/time-card/list/"+n+"/").then((function(e){var n,s=[];Array.from(e.data.data).forEach((function(e,t){s.push({data:e})})),console.log("temp",s),n=s.filter((function(e){return e.data.date_updated>=a&&e.data.date_updated<=t})),console.log("filtered",n);for(var l=0,o=[],c=0;c<n.length;c++)n[c].data.submitted,1==n[c].data.submitted&&(o.push(n[c]),l+=parseFloat(n[c].data.hours_today));console.log("submittedtcs",o),console.log("total hours",l),Object(b.e)(o,r,t,l,a)}))}(e)},size:"sm",type:"button",color:"primary",children:Object(k.jsxs)("u",{children:[" ",e.Name]})})})}}}),Object(k.jsx)("div",{class:"alert alert-info",role:"alert",children:Object(k.jsxs)(o.K,{children:[Object(k.jsx)(o.k,{md:"9"}),Object(b.g)("projects.add_projects")&&Object(k.jsx)(o.k,{md:"3",children:Object(k.jsxs)("small",{children:["   ","Total"," ",Object(k.jsxs)("b",{children:["\xa0",i()(V(),"Name").length," / ",O," \xa0"]}),"Employees Submitted"]})}),!Object(b.g)("projects.add_projects")&&Object(k.jsx)(o.k,{md:"3",children:Object(k.jsxs)("small",{children:["   ","Total"," ",Object(k.jsxs)("b",{children:["\xa0",V().length," "," \xa0"]}),"Submitted"]})})]})})]})})]})})}},584:function(e,t,a){var n=a(164),r=a(616),s=a(621),l=a(165),o=a(622),c=a(162);e.exports=function(e,t,a){var i=-1,d=r,u=e.length,m=!0,f=[],b=f;if(a)m=!1,d=s;else if(u>=200){var O=t?null:o(e);if(O)return c(O);m=!1,d=l,b=new n}else b=t?[]:f;e:for(;++i<u;){var h=e[i],j=t?t(h):h;if(h=a||0!==h?h:0,m&&j===j){for(var g=b.length;g--;)if(b[g]===j)continue e;t&&b.push(j),f.push(h)}else d(b,j,a)||(b!==f&&b.push(j),f.push(h))}return f}},615:function(e,t,a){var n=a(163),r=a(584);e.exports=function(e,t){return e&&e.length?r(e,n(t,2)):[]}},616:function(e,t,a){var n=a(617);e.exports=function(e,t){return!!(null==e?0:e.length)&&n(e,t,0)>-1}},617:function(e,t,a){var n=a(618),r=a(619),s=a(620);e.exports=function(e,t,a){return t===t?s(e,t,a):n(e,r,a)}},618:function(e,t){e.exports=function(e,t,a,n){for(var r=e.length,s=a+(n?1:-1);n?s--:++s<r;)if(t(e[s],s,e))return s;return-1}},619:function(e,t){e.exports=function(e){return e!==e}},620:function(e,t){e.exports=function(e,t,a){for(var n=a-1,r=e.length;++n<r;)if(e[n]===t)return n;return-1}},621:function(e,t){e.exports=function(e,t,a){for(var n=-1,r=null==e?0:e.length;++n<r;)if(a(t,e[n]))return!0;return!1}},622:function(e,t,a){var n=a(166),r=a(623),s=a(162),l=n&&1/s(new n([,-0]))[1]==1/0?function(e){return new n(e)}:r;e.exports=l},623:function(e,t){e.exports=function(){}},625:function(e,t,a){}}]);
//# sourceMappingURL=31.e089d2a3.chunk.js.map