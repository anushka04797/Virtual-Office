(this.webpackJsonpvirtual_office=this.webpackJsonpvirtual_office||[]).push([[40],{1476:function(e,t,a){"use strict";a.r(t);var s=a(9),n=a(33),l=a(5),c=a.n(l),i=a(495),r=a(509),d=a(0),o=a.n(d),m=a(94),b=a(506),u=a(73),j=a.n(u),h=(a(615),a(102)),O=a(669),f=(a(697),a(534)),x=a(11),k=a(4);t.default=function(){var e,t,l,u,p=Object(d.useState)([]),g=Object(n.a)(p,2),y=(g[0],g[1],[]),S=Object(m.c)((function(e){return e.profile.data})),H=Object(m.c)((function(e){var t=[];return Array.from(e.timecardList.user_weekly_submitted_timecards).forEach((function(e,a){t.push({data:e.employee,Weekending:j()(e.week_end).format("ddd, MMMM DD, YYYY"),Name:e.employee.first_name+" "+e.employee.last_name,Total:e.total_hours,RHR:null==e.RHR?"-":e.RHR,SIC:null==e.SIC?"-":e.SIC,HOL:null==e.HOL?"-":e.HOL,WFH:null==e.WFH?"-":e.WFH,OTO:null==e.OTO?"-":e.OTO,PB1:null==e.PB1?"-":e.PB1,Submitted:j()(e.submitted_at).format("ddd, MMMM DD, YYYY")+" at "+j()(e.submitted_at).format("h:mm")})})),y=[].concat(t),t})),w=Object(m.b)();o.a.useEffect((function(){w(Object(h.e)())}),[]);function T(){return(T=Object(s.a)(c.a.mark((function e(){var t,s,n,l,i,r,d,o,m;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=a(917),s=new t.Workbook,(n=s.addWorksheet("sheet1")).mergeCells("B1:F2"),(l=n.getCell("C1")).value="Datasoft Manufacturing & Assembly",l.font={size:15,bold:!0},n.getCell("C1").alignment={horizontal:"center",vertical:"center"},n.mergeCells("C3:D3"),(i=n.getCell("C3")).value="Gulshan Branch",i.font={size:13,bold:!0},i.alignment={horizontal:"center",vertical:"center"},n.mergeCells("A5:B5"),n.getCell("A5").value="Submitted Timecards",n.getRow(8).values=["Weekending","Name","Total","RHR","SIC","HOL","PB1","WFH","OTO","Submitted"],n.getRow(8).font={name:"Arial Black",family:3,size:10},n.getRow(8).height=20,n.columns=[{key:"Weekending",width:20},{key:"Name",width:25},{key:"Total",width:10},{key:"RHR",width:10},{key:"SIC",width:10},{key:"HOL",width:10},{key:"PB1",width:10},{key:"WFH",width:10},{key:"OTO",width:10},{key:"Submitted",width:20}],console.log("submitted",y),r=0;r<y.length;r++)n.addRow({Weekending:y[r].Weekending,Name:y[r].Name,Total:y[r].Total,RHR:y[r].RHR,SIC:y[r].SIC,HOL:y[r].HOL,PB1:y[r].PB1,WFH:y[r].WFH,OTO:y[r].OTO,Submitted:y[r].Submitted});return d=y.length+11,0!=H.length&&(n.getRow(d).values=["Total Submitted =  "+y.length]),e.next=26,s.xlsx.writeBuffer();case 26:o=e.sent,"application/octet-stream",".xlsx",m=new Blob([o],{type:"application/octet-stream"}),"Submitted Timecards .xlsx",Object(f.saveAs)(m,"Submitted Timecards .xlsx");case 32:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var v=Object(x.g)();return Object(k.jsx)(k.Fragment,{children:Object(k.jsxs)(i.l,{children:[Object(k.jsxs)(i.K,{children:[Object(k.jsx)(i.k,{children:Object(k.jsx)("h3",{className:"timecards-page-header mb-3",children:"Submitted Timecards"})}),Object(k.jsxs)(i.k,{md:"8",id:"tableRef",className:"d-flex justify-content-end",children:[Object(k.jsx)("h5",{className:"tiny-header--5 mt-3 mr-2",children:"Export "}),Object(k.jsxs)("div",{className:"format-buttons mt-3 mb-3 ",children:[Object(k.jsxs)(i.f,{className:"file-format-download",onClick:function(){!function(){var e=S.first_name+" "+S.last_name,t=new O.default("portrait","pt","A4");t.setFontSize(15);var a={startY:145,head:[["Weekending","Name","Total","RHR","SIC","HOL","PB1","WFH","OTO","Submitted"]],body:y.map((function(e,t){return[e.Weekending,e.Name,e.Total,e.RHR,e.SIC,e.HOL,e.PB1,e.WFH,e.OTO,e.Submitted,console.log("data",e)]}))};t.text(170,50,"Datasoft Manufacturing & Assembly"),t.setFontSize(13),t.text(245,75,"Gulshan Branch"),t.setFontSize(11),t.text(42,105,"Submitted Time Card"),Object(b.f)("projects.add_projects")||t.text(42,125,"Employee Name: "+e),t.text(440,360,"Total "+y.length+" Submitted"),t.autoTable(a),t.save("Timecard of "+e+".pdf")}()},children:[Object(k.jsx)(r.a,{name:"cil-description",className:"mr-2"})," PDF"]}),Object(k.jsxs)(i.f,{className:"file-format-download",onClick:function(){!function(){T.apply(this,arguments)}()},children:[Object(k.jsx)(r.a,{name:"cil-spreadsheet",className:"mr-2"}),"Excel"]})]})]})]}),Object(k.jsx)(i.K,{className:"mt-4",children:Object(k.jsx)(i.k,{children:Object(k.jsxs)(i.z,{className:"custom-label-5",htmlFor:"assigneeSelect",children:["Company :"," ",null===(e=S.slc_details)||void 0===e||null===(t=e.slc)||void 0===t||null===(l=t.department)||void 0===l||null===(u=l.company)||void 0===u?void 0:u.name]})})}),Object(k.jsx)(i.K,{children:!Object(b.f)("projects.add_projects")&&Object(k.jsx)(i.k,{children:Object(k.jsxs)(i.z,{className:"custom-label-5",htmlFor:"assigneeSelect",children:["Employee Name :"," ",Object(b.b)(S.first_name)+" "+Object(b.b)(S.last_name)]})})}),Object(k.jsx)(i.K,{className:"mt-5",children:Object(k.jsxs)(i.k,{children:[Object(k.jsx)(i.m,{items:H,fields:[{key:"Weekending",_style:{width:"15%"},_classes:"font-weight-bold"},"Name","Total",{key:"RHR",sorter:!1},{key:"SIC",sorter:!1},{key:"HOL",sorter:!1},{key:"PB1",sorter:!1},{key:"WFH",sorter:!1},{key:"OTO",sorter:!1},{key:"Submitted",sorter:!1}],itemsPerPage:10,pagination:!0,striped:!0,bordered:!0,sorter:!0,scopedSlots:{Name:function(e){return Object(k.jsx)("td",{children:Object(k.jsx)("a",{onClick:function(){v.push({pathname:"/dashboard/timecard/generate-timecard",state:{assignee:e.data.id}})},size:"sm",type:"button",color:"primary",children:Object(k.jsxs)("u",{children:[" ",e.Name]})})})}}}),Object(k.jsx)("div",{class:"alert alert-info",role:"alert",children:Object(k.jsxs)(i.K,{children:[Object(k.jsx)(i.k,{md:"5"}),Object(k.jsx)(i.k,{md:"3"}),Object(k.jsx)(i.k,{md:"4",children:Object(k.jsxs)("small",{children:["   ","Total ",Object(k.jsxs)("b",{children:["\xa0",H.length,"\xa0"]})," ","Submitted"]})})]})})]})})]})})}},615:function(e,t,a){}}]);
//# sourceMappingURL=40.ffcdfe46.chunk.js.map